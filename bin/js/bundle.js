var __extends = (this && this.__extends) || (function () {
    var extendStatics = Object.setPrototypeOf ||
        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||
        function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };
    return function (d, b) {
        extendStatics(d, b);
        function __() { this.constructor = d; }
        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
    };
})();
(function(){function r(e,n,t){function o(i,f){if(!n[i]){if(!e[i]){var c="function"==typeof require&&require;if(!f&&c)return c(i,!0);if(u)return u(i,!0);var a=new Error("Cannot find module '"+i+"'");throw a.code="MODULE_NOT_FOUND",a}var p=n[i]={exports:{}};e[i][0].call(p.exports,function(r){var n=e[i][1][r];return o(n||r)},p,p.exports,r,e,n,t)}return n[i].exports}for(var u="function"==typeof require&&require,i=0;i<t.length;i++)o(t[i]);return o}return r})()({1:[function(require,module,exports){
!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports):"function"==typeof define&&define.amd?define(["exports"],e):e(t.ash={})}(this,function(t){"use strict";class e{constructor(){this.previous=null,this.next=null,this.listener=null,this.once=!1}}class s{constructor(){this.tail=null,this.cacheTail=null}get(){if(this.tail){const t=this.tail;return this.tail=this.tail.previous,t.previous=null,t}return new e}dispose(t){t.listener=null,t.once=!1,t.next=null,t.previous=this.tail,this.tail=t}cache(t){t.listener=null,t.previous=this.cacheTail,this.cacheTail=t}releaseCache(){for(;this.cacheTail;){const t=this.cacheTail;this.cacheTail=t.previous,t.next=null,t.previous=this.tail,this.tail=t}}}class i{constructor(){this.head=null,this.tail=null,this.toAddHead=null,this.toAddTail=null,this.dispatching=!1,this.pNumListeners=0,this.nodes=new Map,this.listenerNodePool=new s}startDispatch(){this.dispatching=!0}endDispatch(){this.dispatching=!1,this.toAddHead&&(this.head?(this.tail.next=this.toAddHead,this.toAddHead.previous=this.tail,this.tail=this.toAddTail):(this.head=this.toAddHead,this.tail=this.toAddTail),this.toAddHead=null,this.toAddTail=null),this.listenerNodePool.releaseCache()}get numListeners(){return this.pNumListeners}add(t){if(this.nodes.has(t))return;const e=this.listenerNodePool.get();e.listener=t,this.nodes.set(t,e),this.addNode(e)}addOnce(t){if(this.nodes.has(t))return;const e=this.listenerNodePool.get();e.listener=t,e.once=!0,this.nodes.set(t,e),this.addNode(e)}addNode(t){this.dispatching?this.toAddHead?(this.toAddTail.next=t,t.previous=this.toAddTail,this.toAddTail=t):this.toAddHead=this.toAddTail=t:this.head?(this.tail.next=t,t.previous=this.tail,this.tail=t):this.head=this.tail=t,this.pNumListeners+=1}remove(t){const e=this.nodes.get(t)||null;e&&(this.head===e&&(this.head=this.head.next),this.tail===e&&(this.tail=this.tail.previous),this.toAddHead===e&&(this.toAddHead=this.toAddHead.next),this.toAddTail===e&&(this.toAddTail=this.toAddTail.previous),e.previous&&(e.previous.next=e.next),e.next&&(e.next.previous=e.previous),this.nodes.delete(t),this.dispatching?this.listenerNodePool.cache(e):this.listenerNodePool.dispose(e),this.pNumListeners-=1)}removeAll(){for(;this.head;){const t=this.head;this.head=this.head.next,this.nodes.delete(t.listener),this.listenerNodePool.dispose(t)}this.tail=null,this.toAddHead=null,this.toAddTail=null,this.pNumListeners=0}}class n extends i{dispatch(){let t;for(this.startDispatch(),t=this.head;t;t=t.next)t.listener.call(t),t.once&&this.remove(t.listener);this.endDispatch()}}class o extends i{dispatch(t){let e;for(this.startDispatch(),e=this.head;e;e=e.next)e.listener.call(e,t),e.once&&this.remove(e.listener);this.endDispatch()}}class h extends i{dispatch(t,e){let s;for(this.startDispatch(),s=this.head;s;s=s.next)s.listener.call(s,t,e),s.once&&this.remove(s.listener);this.endDispatch()}}class r{constructor(){this.head=null,this.tail=null,this.nodeAdded=new o,this.nodeRemoved=new o}add(t){this.head?(this.tail.next=t,t.previous=this.tail,t.next=null,this.tail=t):(this.head=this.tail=t,t.next=t.previous=null),this.nodeAdded.dispatch(t)}remove(t){this.head===t&&(this.head=this.head.next),this.tail===t&&(this.tail=this.tail.previous),t.previous&&(t.previous.next=t.next),t.next&&(t.next.previous=t.previous),this.nodeRemoved.dispatch(t)}removeAll(){for(;this.head;){const t=this.head;this.head=t.next,t.previous=null,t.next=null,this.nodeRemoved.dispatch(t)}this.tail=null}get empty(){return null==this.head}swap(t,e){if(t.previous===e)t.previous=e.previous,e.previous=t,e.next=t.next,t.next=e;else if(e.previous===t)e.previous=t.previous,t.previous=e,t.next=e.next,e.next=t;else{let s=t.previous;t.previous=e.previous,e.previous=s,s=t.next,t.next=e.next,e.next=s}this.head===t?this.head=e:this.head===e&&(this.head=t),this.tail===t?this.tail=e:this.tail===e&&(this.tail=t),t.previous&&(t.previous.next=t),e.previous&&(e.previous.next=e),t.next&&(t.next.previous=t),e.next&&(e.next.previous=e)}insertionSort(t){if(this.head===this.tail)return;let e=this.head.next;for(let s=e;s;s=e){let i;for(e=s.next,i=s.previous;i;i=i.previous)if(t(s,i)>=0){s!==i.next&&(this.tail===s&&(this.tail=s.previous),s.previous.next=s.next,s.next&&(s.next.previous=s.previous),s.next=i.next,s.previous=i,s.next.previous=s,i.next=s);break}i||(this.tail===s&&(this.tail=s.previous),s.previous.next=s.next,s.next&&(s.next.previous=s.previous),s.next=this.head,this.head.previous=s,s.previous=null,this.head=s)}}mergeSort(t){if(this.head===this.tail)return;const e=[];let s,i=this.head;for(;i;){for(s=i;s.next&&t(s,s.next)<=0;)s=s.next;const n=s.next;i.previous=s.next=null,e[e.length]=i,i=n}for(;e.length>1;)e.push(this.merge(e.shift(),e.shift(),t));for(this.tail=this.head=e[0];this.tail.next;)this.tail=this.tail.next}merge(t,e,s){let i,n;for(s(t,e)<=0?(n=i=t,t=t.next):(n=i=e,e=e.next);t&&e;)s(t,e)<=0?(i.next=t,t.previous=i,i=t,t=t.next):(i.next=e,e.previous=i,i=e,e=e.next);return t?(i.next=t,t.previous=i):(i.next=e,e.previous=i),n}}class a{constructor(t,e){this.tail=null,this.cacheTail=null,this.nodeClass=t,this.components=e}get(){if(this.tail){const t=this.tail;return this.tail=this.tail.previous,t.previous=null,t}return new this.nodeClass}dispose(t){for(const e of this.components.values())t[e]=null;t.entity=null,t.next=null,t.previous=this.tail,this.tail=t}cache(t){t.previous=this.cacheTail,this.cacheTail=t}releaseCache(){for(;this.cacheTail;){const t=this.cacheTail;this.cacheTail=t.previous,this.dispose(t)}}}const d="__ash_types__";class l{constructor(t,e){this.releaseNodePoolCache=(()=>{this.engine.updateComplete.remove(this.releaseNodePoolCache),this.nodePool.releaseCache()}),this.nodeClass=t,this.engine=e,this.init()}init(){this.nodes=new r,this.entities=new Map,this.components=new Map,this.nodePool=new a(this.nodeClass,this.components);const t=this.nodePool.get();this.nodePool.dispose(t);const e=t.constructor[d];for(const[t,s]of e)this.components.set(s,t)}get nodeList(){return this.nodes}newEntity(t){this.addIfMatch(t)}componentAddedToEntity(t,e){this.addIfMatch(t)}componentRemovedFromEntity(t,e){this.components.has(e)&&this.removeIfMatch(t)}removeEntity(t){this.removeIfMatch(t)}addIfMatch(t){if(!this.entities.has(t)){for(const e of this.components.keys())if(!t.has(e))return;const e=this.nodePool.get();e.entity=t;for(const s of this.components.keys())e[this.components.get(s)]=t.get(s);this.entities.set(t,e),this.nodes.add(e)}}removeIfMatch(t){if(this.entities.has(t)){const e=this.entities.get(t);this.entities.delete(t),this.nodes.remove(e),this.engine.updating?(this.nodePool.cache(e),this.engine.updateComplete.add(this.releaseNodePoolCache)):this.nodePool.dispose(e)}}cleanUp(){for(let t=this.nodes.head;t;t=t.next)this.entities.delete(t.entity);this.nodes.removeAll()}}class c{constructor(){this.head=null,this.tail=null}add(t){this.head?(this.tail.next=t,t.previous=this.tail,t.next=null,this.tail=t):(this.head=this.tail=t,t.next=t.previous=null)}remove(t){this.head===t&&(this.head=this.head.next),this.tail===t&&(this.tail=this.tail.previous),t.previous&&(t.previous.next=t.next),t.next&&(t.next.previous=t.previous)}removeAll(){for(;this.head;){const t=this.head;this.head=this.head.next,t.previous=null,t.next=null}this.tail=null}}class u{constructor(){this.head=null,this.tail=null}add(t){if(this.head){let e;for(e=this.tail;e&&!(e.priority<=t.priority);e=e.previous);e===this.tail?(this.tail.next=t,t.previous=this.tail,t.next=null,this.tail=t):e?(t.next=e.next,t.previous=e,e.next.previous=t,e.next=t):(t.next=this.head,t.previous=null,this.head.previous=t,this.head=t)}else this.head=this.tail=t,t.next=t.previous=null}remove(t){this.head===t&&(this.head=this.head.next),this.tail===t&&(this.tail=this.tail.previous),t.previous&&(t.previous.next=t.next),t.next&&(t.next.previous=t.previous)}removeAll(){for(;this.head;){const t=this.head;this.head=this.head.next,t.previous=null,t.next=null}this.tail=null}get(t){for(let e=this.head;e;e=e.next)if(e instanceof t)return e;return null}}class p{constructor(t=""){this.previous=null,this.next=null,this.componentAdded=new h,this.componentRemoved=new h,this.nameChanged=new h,this.components=new Map,t?this.pName=t:(p.nameCount+=1,this.pName="_entity"+p.nameCount)}get name(){return this.pName}set name(t){if(this.pName!==t){const e=this.pName;this.pName=t,this.nameChanged.dispatch(this,e)}}add(t,e=null){return e||(e=t.constructor.prototype.constructor),e=e,this.components.has(e)&&this.remove(e),this.components.set(e,t),this.componentAdded.dispatch(this,e),this}remove(t){const e=this.components.get(t);return e?(this.components.delete(t),this.componentRemoved.dispatch(this,t),e):null}get(t){return this.components.get(t)}getAll(){const t=[];for(const e of this.components.values())t[t.length]=e;return t}has(t){return this.components.has(t)}}p.nameCount=0;class m{constructor(){this.previous=null,this.next=null,this.priority=0}}class v{constructor(t){this.instance=t}getComponent(){return this.instance}get identifier(){return this.instance}}class y{constructor(t){this.componentType=t}getComponent(){return this.instance||(this.instance=new this.componentType),this.instance}get identifier(){return this.getComponent()}}class f{constructor(t){this.componentType=t}getComponent(){return new this.componentType}get identifier(){return this.componentType}}class g{constructor(t){this.closure=t}getComponent(){return this.closure()}get identifier(){return this.closure}}class x{constructor(t,e){this.creatingState=t,this.componentType=e,this.withType(e)}withInstance(t){return this.setProvider(new v(t)),this}withType(t){return this.setProvider(new f(t)),this}withSingleton(t){return t||(t=this.componentType),this.setProvider(new y(t)),this}withMethod(t){return this.setProvider(new g(t)),this}withProvider(t){return this.setProvider(t),this}add(t){return this.creatingState.add(t)}setProvider(t){this.provider=t,this.creatingState.providers.set(this.componentType,t)}}class w{constructor(){this.providers=new Map}add(t){return new x(this,t)}get(t){return this.providers.get(t)||null}has(t){return this.providers.has(t)}}class A{constructor(t){this.systemPriority=0,this.method=t}getSystem(){return this.method()}get identifier(){return this.method}get priority(){return this.systemPriority}set priority(t){this.systemPriority=t}}class T{constructor(t,e){this.creatingState=t,this.provider=e}withPriority(t){return this.provider.priority=t,this}addInstance(t){return this.creatingState.addInstance(t)}addSingleton(t){return this.creatingState.addSingleton(t)}addMethod(t){return this.creatingState.addMethod(t)}addProvider(t){return this.creatingState.addProvider(t)}}class P{constructor(t){this.systemPriority=0,this.instance=t}getSystem(){return this.instance}get identifier(){return this.instance}get priority(){return this.systemPriority}set priority(t){this.systemPriority=t}}class S{constructor(t){this.systemPriority=0,this.componentType=t}getSystem(){return this.instance||(this.instance=new this.componentType),this.instance}get identifier(){return this.getSystem()}get priority(){return this.systemPriority}set priority(t){this.systemPriority=t}}class N{constructor(){this.providers=[]}addInstance(t){return this.addProvider(new P(t))}addSingleton(t){return this.addProvider(new S(t))}addMethod(t){return this.addProvider(new A(t))}addProvider(t){const e=new T(this,t);return this.providers[this.providers.length]=t,e}}class L{static getPool(t){if(L.pools.has(t))return L.pools.get(t);const e=[];return L.pools.set(t,e),e}static get(t){const e=L.getPool(t);return e.length>0?e.pop():new t}static dispose(t){if(t){const e=t.constructor.prototype.constructor,s=L.getPool(e);s[s.length]=t}}static empty(){L.pools=new Map}}L.pools=new Map;t.Signal0=n,t.Signal1=o,t.Signal2=h,t.Signal3=class extends i{dispatch(t,e,s){let i;for(this.startDispatch(),i=this.head;i;i=i.next)i.listener.call(i,t,e,s),i.once&&this.remove(i.listener);this.endDispatch()}},t.ComponentMatchingFamily=l,t.keep=function(t){return(e,s)=>{const i=e.constructor;let n;i.hasOwnProperty(d)?n=i[d]:(n=new Map,Object.defineProperty(i,d,{enumerable:!0,get:()=>n})),n.set(s,t)}},t.Engine=class{constructor(){this.updating=!1,this.familyClass=l,this.entityNameChanged=((t,e)=>{this.entityNames.get(e)===t&&(this.entityNames.delete(e),this.entityNames.set(t.name,t))}),this.componentAdded=((t,e)=>{for(const s of this.families.values())s.componentAddedToEntity(t,e)}),this.componentRemoved=((t,e)=>{for(const s of this.families.values())s.componentRemovedFromEntity(t,e)}),this.entityList=new c,this.entityNames=new Map,this.systemList=new u,this.families=new Map,this.updateComplete=new n}addEntity(t){if(this.entityNames.has(t.name))throw new Error("The entity name "+t.name+" is already in use by another entity.");this.entityList.add(t),this.entityNames.set(t.name,t),t.componentAdded.add(this.componentAdded),t.componentRemoved.add(this.componentRemoved),t.nameChanged.add(this.entityNameChanged);for(const e of this.families.values())e.newEntity(t)}removeEntity(t){t.componentAdded.remove(this.componentAdded),t.componentRemoved.remove(this.componentRemoved),t.nameChanged.remove(this.entityNameChanged);for(const e of this.families.values())e.removeEntity(t);this.entityNames.delete(t.name),this.entityList.remove(t)}getEntityByName(t){return this.entityNames.get(t)||null}removeAllEntities(){for(;this.entityList.head;)this.removeEntity(this.entityList.head)}get entities(){const t=[];for(let e=this.entityList.head;e;e=e.next)t[t.length]=e;return t}getNodeList(t){if(this.families.has(t))return this.families.get(t).nodeList;const e=new this.familyClass(t,this);this.families.set(t,e);for(let t=this.entityList.head;t;t=t.next)e.newEntity(t);return e.nodeList}releaseNodeList(t){this.families.has(t)&&this.families.get(t).cleanUp(),this.families.delete(t)}addSystem(t,e){t.priority=e,t.addToEngine(this),this.systemList.add(t)}getSystem(t){return this.systemList.get(t)}get systems(){const t=[];for(let e=this.systemList.head;e;e=e.next)t[t.length]=e;return t}removeSystem(t){this.systemList.remove(t),t.removeFromEngine(this)}removeAllSystems(){for(;this.systemList.head;){const t=this.systemList.head;this.systemList.head=this.systemList.head.next,t.previous=null,t.next=null,t.removeFromEngine(this)}this.systemList.tail=null}update(t){this.updating=!0;for(let e=this.systemList.head;e;e=e.next)e.update(t);this.updating=!1,this.updateComplete.dispatch()}},t.Entity=p,t.Node=class{constructor(){this.entity=null,this.previous=null,this.next=null}},t.NodeList=r,t.NodePool=a,t.System=m,t.EntityStateMachine=class{constructor(t){this.entity=t,this.states={}}addState(t,e){return this.states[t]=e,this}createState(t){const e=new w;return this.states[t]=e,e}changeState(t){let e,s=this.states[t];if(!s)throw new Error(`Entity state ${t} doesn't exist`);if(s!==this.currentState){if(this.currentState){e=new Map;for(const t of s.providers.keys())e.set(t,s.providers.get(t));for(const t of this.currentState.providers.keys()){const s=e.get(t)||null;s&&s.identifier===this.currentState.providers.get(t).identifier?e.delete(t):this.entity.remove(t)}}else e=s.providers;for(const t of e.keys())this.entity.add(e.get(t).getComponent(),t);this.currentState=s}else s=null}},t.EngineStateMachine=class{constructor(t){this.engine=t,this.states={}}addState(t,e){return this.states[t]=e,this}createState(t){const e=new N;return this.states[t]=e,e}changeState(t){let e=this.states[t];if(!e)throw new Error(`Engine state ${t} doesn't exist`);if(e===this.currentState)return void(e=null);const s=[];let i;for(const t of e.providers)s[i=t.identifier]=t;if(this.currentState)for(const t of this.currentState.providers)s[i=t.identifier]?delete s[i]:this.engine.removeSystem(t.getSystem());for(const t of s)this.engine.addSystem(t.getSystem(),t.priority);this.currentState=e}},t.RAFTickProvider=class extends o{constructor(){super(...arguments),this.rafId=0,this.previousTime=0,this.update=(()=>{this.rafId=window.requestAnimationFrame(this.update);const t=Date.now();this.dispatch((t-this.previousTime)/1e3),this.previousTime=t})}start(){this.previousTime=Date.now(),this.rafId=window.requestAnimationFrame(this.update)}stop(){window.cancelAnimationFrame(this.rafId),this.rafId=0}get playing(){return!!this.rafId}},t.IntervalTickProvider=class extends o{constructor(t){super(),this.intervalId=0,this.previousTime=0,this.pInterval=33,this.update=(()=>{const t=Date.now();this.dispatch((t-this.previousTime)/1e3),this.previousTime=t}),t&&(this.pInterval=t)}start(){this.previousTime=Date.now(),this.intervalId=window.setInterval(this.update,this.pInterval)}stop(){window.clearInterval(this.intervalId),this.intervalId=0}set interval(t){this.pInterval=t,0!==this.intervalId&&(window.clearInterval(this.intervalId),this.intervalId=window.setInterval(this.update,t))}get inteval(){return this.pInterval}get playing(){return!!this.intervalId}},t.ComponentPool=L,t.ListIteratingSystem=class extends m{constructor(t){super(),this.nodeList=null,this.nodeClass=t}addToEngine(t){if(this.nodeList=t.getNodeList(this.nodeClass),this.nodeAdded){for(let t=this.nodeList.head;t;t=t.next)this.nodeAdded(t);this.nodeList.nodeAdded.add(this.nodeAdded)}this.nodeRemoved&&this.nodeList.nodeRemoved.add(this.nodeRemoved)}removeFromEngine(t){this.nodeAdded&&this.nodeList.nodeAdded.remove(this.nodeAdded),this.nodeRemoved&&this.nodeList.nodeRemoved.remove(this.nodeRemoved),this.nodeList=null}update(t){for(let e=this.nodeList.head;e;e=e.next)this.updateNode(e,t)}},Object.defineProperty(t,"__esModule",{value:!0})});

},{}],2:[function(require,module,exports){
"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
/**This class is automatically generated by LayaAirIDE, please do not make any modifications. */
const GameUI_1 = require("./script/GameUI");
const GameControl_1 = require("./script/GameControl");
const Bullet_1 = require("./script/Bullet");
const DropBox_1 = require("./script/DropBox");
/*
* 游戏初始化配置;
*/
class GameConfig {
    constructor() { }
    static init() {
        var reg = Laya.ClassUtils.regClass;
        reg("script/GameUI.ts", GameUI_1.default);
        reg("script/GameControl.ts", GameControl_1.default);
        reg("script/Bullet.ts", Bullet_1.default);
        reg("script/DropBox.ts", DropBox_1.default);
    }
}
GameConfig.width = 640;
GameConfig.height = 1136;
GameConfig.scaleMode = "fixedwidth";
GameConfig.screenMode = "none";
GameConfig.startScene = "test/TestScene.scene";
GameConfig.sceneRoot = "";
GameConfig.debug = false;
GameConfig.stat = false;
GameConfig.physicsDebug = false;
GameConfig.exportSceneToJson = true;
exports.default = GameConfig;
GameConfig.init();
},{"./script/Bullet":8,"./script/DropBox":9,"./script/GameControl":10,"./script/GameUI":11}],3:[function(require,module,exports){
"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
const GameConfig_1 = require("./GameConfig");
const ash_ts_1 = require("ash.ts");
const MoveSystem_1 = require("./ces/systems/MoveSystem");
const PositionComponent_1 = require("./ces/components/PositionComponent");
const SpeedComponent_1 = require("./ces/components/SpeedComponent");
class Main {
    constructor() {
        //根据IDE设置初始化引擎		
        if (window["Laya3D"])
            Laya3D.init(GameConfig_1.default.width, GameConfig_1.default.height);
        else
            Laya.init(GameConfig_1.default.width, GameConfig_1.default.height, Laya["WebGL"]);
        Laya["Physics"] && Laya["Physics"].enable();
        Laya["DebugPanel"] && Laya["DebugPanel"].enable();
        Laya.stage.scaleMode = GameConfig_1.default.scaleMode;
        Laya.stage.screenMode = GameConfig_1.default.screenMode;
        //兼容微信不支持加载scene后缀场景
        Laya.URL.exportSceneToJson = GameConfig_1.default.exportSceneToJson;
        //打开调试面板（通过IDE设置调试模式，或者url地址增加debug=true参数，均可打开调试面板）
        if (GameConfig_1.default.debug || Laya.Utils.getQueryString("debug") == "true")
            Laya.enableDebugPanel();
        if (GameConfig_1.default.physicsDebug && Laya["PhysicsDebugDraw"])
            Laya["PhysicsDebugDraw"].enable();
        if (GameConfig_1.default.stat)
            Laya.Stat.show();
        Laya.alertGlobalError = true;
        //激活资源版本控制，version.json由IDE发布功能自动生成，如果没有也不影响后续流程
        //Laya.ResourceVersion.enable("version.json", Laya.Handler.create(this, this.onVersionLoaded), Laya.ResourceVersion.FILENAME_VERSION);
        this.init();
    }
    onVersionLoaded() {
        //激活大小图映射，加载小图的时候，如果发现小图在大图合集里面，则优先加载大图合集，而不是小图
        Laya.AtlasInfoManager.enable("fileconfig.json", Laya.Handler.create(this, this.onConfigLoaded));
    }
    onConfigLoaded() {
        //加载IDE指定的场景
        GameConfig_1.default.startScene && Laya.Scene.open(GameConfig_1.default.startScene);
    }
    init() {
        this._engine = new ash_ts_1.Engine();
        this._engine.addSystem(new MoveSystem_1.MoveSystem(), 0);
        Laya.timer.loop(1000, this, this.update);
    }
    update() {
        this._engine.update(Laya.timer.delta);
    }
    setup() {
        let entity = new ash_ts_1.Entity();
        let position = ash_ts_1.ComponentPool.get(PositionComponent_1.PositionComponent);
        position.initialize(2, 3, 4);
        entity.add(position);
        let speed = ash_ts_1.ComponentPool.get(SpeedComponent_1.SpeedComponent);
        speed.initialize(10, 2, 1);
        entity.add(speed);
        this._engine.addEntity(entity);
    }
}
//激活启动类
new Main().setup();
},{"./GameConfig":2,"./ces/components/PositionComponent":4,"./ces/components/SpeedComponent":5,"./ces/systems/MoveSystem":7,"ash.ts":1}],4:[function(require,module,exports){
"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
class PositionComponent {
    constructor() {
    }
    initialize(x = 0.0, y = 0.0, z = 0.0) {
        this.posX = x;
        this.posY = y;
        this.posZ = z;
    }
}
exports.PositionComponent = PositionComponent;
},{}],5:[function(require,module,exports){
"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
class SpeedComponent {
    constructor() {
    }
    initialize(x = 0.0, y = 0.0, z = 0.0) {
        this.speedX = x;
        this.speedY = y;
        this.speedZ = z;
    }
}
exports.SpeedComponent = SpeedComponent;
},{}],6:[function(require,module,exports){
"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
const ash_ts_1 = require("ash.ts");
const PositionComponent_1 = require("../components/PositionComponent");
const SpeedComponent_1 = require("../components/SpeedComponent");
class MoveNode extends ash_ts_1.Node {
}
__decorate([
    ash_ts_1.keep(PositionComponent_1.PositionComponent),
    __metadata("design:type", PositionComponent_1.PositionComponent)
], MoveNode.prototype, "pos", void 0);
__decorate([
    ash_ts_1.keep(SpeedComponent_1.SpeedComponent),
    __metadata("design:type", SpeedComponent_1.SpeedComponent)
], MoveNode.prototype, "speed", void 0);
exports.MoveNode = MoveNode;
},{"../components/PositionComponent":4,"../components/SpeedComponent":5,"ash.ts":1}],7:[function(require,module,exports){
"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
const ash_ts_1 = require("ash.ts");
const MoveNode_1 = require("../nodes/MoveNode");
class MoveSystem extends ash_ts_1.ListIteratingSystem {
    constructor() {
        super(MoveNode_1.MoveNode);
    }
    updateNode(node, delta) {
        node.pos.posX += node.speed.speedX;
        console.log("x: " + node.pos.posX);
    }
}
exports.MoveSystem = MoveSystem;
},{"../nodes/MoveNode":6,"ash.ts":1}],8:[function(require,module,exports){
"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
/**
 * 子弹脚本，实现子弹飞行逻辑及对象池回收机制
 */
class Bullet extends Laya.Script {
    constructor() { super(); }
    onEnable() {
        //设置初始速度
        var rig = this.owner.getComponent(Laya.RigidBody);
        rig.setVelocity({ x: 0, y: -10 });
    }
    onTriggerEnter(other, self, contact) {
        //如果被碰到，则移除子弹
        this.owner.removeSelf();
    }
    onUpdate() {
        //如果子弹超出屏幕，则移除子弹
        if (this.owner.y < -10) {
            this.owner.removeSelf();
        }
    }
    onDisable() {
        //子弹被移除时，回收子弹到对象池，方便下次复用，减少对象创建开销
        Laya.Pool.recover("bullet", this.owner);
    }
}
exports.default = Bullet;
},{}],9:[function(require,module,exports){
"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
const GameUI_1 = require("./GameUI");
/**
 * 掉落盒子脚本，实现盒子碰撞及回收流程
 */
class DropBox extends Laya.Script {
    constructor() {
        super();
        /**盒子等级 */
        this.level = 1;
    }
    onEnable() {
        /**获得组件引用，避免每次获取组件带来不必要的查询开销 */
        this._rig = this.owner.getComponent(Laya.RigidBody);
        this.level = Math.round(Math.random() * 5) + 1;
        this._text = this.owner.getChildByName("levelTxt");
        this._text.text = this.level + "";
    }
    onUpdate() {
        //让持续盒子旋转
        this.owner.rotation++;
    }
    onTriggerEnter(other, self, contact) {
        var owner = this.owner;
        if (other.label === "buttle") {
            //碰撞到子弹后，增加积分，播放声音特效
            if (this.level > 1) {
                this.level--;
                this._text.changeText(this.level + "");
                owner.getComponent(Laya.RigidBody).setVelocity({ x: 0, y: -10 });
                Laya.SoundManager.playSound("sound/hit.wav");
            }
            else {
                if (owner.parent) {
                    let effect = Laya.Pool.getItemByCreateFun("effect", this.createEffect, this);
                    effect.pos(owner.x, owner.y);
                    owner.parent.addChild(effect);
                    effect.play(0, true);
                    owner.removeSelf();
                    Laya.SoundManager.playSound("sound/destroy.wav");
                }
            }
            GameUI_1.default.instance.addScore(1);
        }
        else if (other.label === "ground") {
            //只要有一个盒子碰到地板，则停止游戏
            owner.removeSelf();
            GameUI_1.default.instance.stopGame();
        }
    }
    /**使用对象池创建爆炸动画 */
    createEffect() {
        let ani = new Laya.Animation();
        ani.loadAnimation("test/TestAni.ani");
        ani.on(Laya.Event.COMPLETE, null, recover);
        function recover() {
            ani.removeSelf();
            Laya.Pool.recover("effect", ani);
        }
        return ani;
    }
    onDisable() {
        //盒子被移除时，回收盒子到对象池，方便下次复用，减少对象创建开销。
        Laya.Pool.recover("dropBox", this.owner);
    }
}
exports.default = DropBox;
},{"./GameUI":11}],10:[function(require,module,exports){
"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
/**
 * 游戏控制脚本。定义了几个dropBox，bullet，createBoxInterval等变量，能够在IDE显示及设置该变量
 * 更多类型定义，请参考官方文档
 */
class GameControl extends Laya.Script {
    constructor() {
        super();
        /** @prop {name:createBoxInterval,tips:"间隔多少毫秒创建一个下跌的容器",type:int,default:1000}*/
        this.createBoxInterval = 1000;
        /**开始时间*/
        this._time = 0;
        /**是否已经开始游戏 */
        this._started = false;
    }
    onEnable() {
        this._time = Date.now();
        this._gameBox = this.owner.getChildByName("gameBox");
        this.createBox();
    }
    onUpdate() {
        //每间隔一段时间创建一个盒子
        let now = Date.now();
        if (now - this._time > this.createBoxInterval) {
            this._time = now;
            this.createBox();
        }
    }
    createBox() {
        //使用对象池创建盒子
        let box = Laya.Pool.getItemByCreateFun("dropBox", this.dropBox.create, this.dropBox);
        box.pos(Math.random() * (Laya.stage.width - 100), -100);
        this._gameBox.addChild(box);
    }
    onStageClick(e) {
        //停止事件冒泡，提高性能，当然也可以不要
        e.stopPropagation();
        //舞台被点击后，使用对象池创建子弹
        let flyer = Laya.Pool.getItemByCreateFun("bullet", this.bullet.create, this.bullet);
        flyer.pos(Laya.stage.mouseX, Laya.stage.mouseY);
        this._gameBox.addChild(flyer);
    }
    /**开始游戏，通过激活本脚本方式开始游戏*/
    startGame() {
        if (!this._started) {
            this._started = true;
            this.enabled = true;
        }
    }
    /**结束游戏，通过非激活本脚本停止游戏 */
    stopGame() {
        this._started = false;
        this.enabled = false;
        this.createBoxInterval = 1000;
        this._gameBox.removeChildren();
    }
}
exports.default = GameControl;
},{}],11:[function(require,module,exports){
"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
const layaMaxUI_1 = require("./../ui/layaMaxUI");
const GameControl_1 = require("./GameControl");
/**
 * 本示例采用非脚本的方式实现，而使用继承页面基类，实现页面逻辑。在IDE里面设置场景的Runtime属性即可和场景进行关联
 * 相比脚本方式，继承式页面类，可以直接使用页面定义的属性（通过IDE内var属性定义），比如this.tipLbll，this.scoreLbl，具有代码提示效果
 * 建议：如果是页面级的逻辑，需要频繁访问页面内多个元素，使用继承式写法，如果是独立小模块，功能单一，建议用脚本方式实现，比如子弹脚本。
 */
class GameUI extends layaMaxUI_1.ui.test.TestSceneUI {
    constructor() {
        super();
        GameUI.instance = this;
        //关闭多点触控，否则就无敌了
        Laya.MouseManager.multiTouchEnabled = false;
    }
    onEnable() {
        this._control = this.getComponent(GameControl_1.default);
        //点击提示文字，开始游戏
        this.tipLbll.on(Laya.Event.CLICK, this, this.onTipClick);
    }
    onTipClick(e) {
        this.tipLbll.visible = false;
        this._score = 0;
        this.scoreLbl.text = "";
        this._control.startGame();
    }
    /**增加分数 */
    addScore(value = 1) {
        this._score += value;
        this.scoreLbl.changeText("分数：" + this._score);
        //随着分数越高，难度增大
        if (this._control.createBoxInterval > 600 && this._score % 20 == 0)
            this._control.createBoxInterval -= 20;
    }
    /**停止游戏 */
    stopGame() {
        this.tipLbll.visible = true;
        this.tipLbll.text = "游戏结束了，点击屏幕重新开始";
        this._control.stopGame();
    }
}
exports.default = GameUI;
},{"./../ui/layaMaxUI":12,"./GameControl":10}],12:[function(require,module,exports){
"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
var Scene = Laya.Scene;
var ui;
(function (ui) {
    var test;
    (function (test) {
        class TestSceneUI extends Scene {
            constructor() { super(); }
            createChildren() {
                super.createChildren();
                this.loadScene("test/TestScene");
            }
        }
        test.TestSceneUI = TestSceneUI;
    })(test = ui.test || (ui.test = {}));
})(ui = exports.ui || (exports.ui = {}));
},{}]},{},[3])
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIkY6L3NvZnR3YXJlL2xheWFhaXIyLjAvcmVzb3VyY2VzL2FwcC9ub2RlX21vZHVsZXMvYnJvd3Nlci1wYWNrL19wcmVsdWRlLmpzIiwibm9kZV9tb2R1bGVzL2FzaC50cy9kaXN0L2FzaC50cy5taW4uanMiLCJzcmMvR2FtZUNvbmZpZy50cyIsInNyYy9NYWluLnRzIiwic3JjL2Nlcy9jb21wb25lbnRzL1Bvc2l0aW9uQ29tcG9uZW50LnRzIiwic3JjL2Nlcy9jb21wb25lbnRzL1NwZWVkQ29tcG9uZW50LnRzIiwic3JjL2Nlcy9ub2Rlcy9Nb3ZlTm9kZS50cyIsInNyYy9jZXMvc3lzdGVtcy9Nb3ZlU3lzdGVtLnRzIiwic3JjL3NjcmlwdC9CdWxsZXQudHMiLCJzcmMvc2NyaXB0L0Ryb3BCb3gudHMiLCJzcmMvc2NyaXB0L0dhbWVDb250cm9sLnRzIiwic3JjL3NjcmlwdC9HYW1lVUkudHMiLCJzcmMvdWkvbGF5YU1heFVJLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUNWQTtBQUNBOzs7O0FDREEsZ0dBQWdHO0FBQ2hHLDRDQUFvQztBQUNwQyxzREFBOEM7QUFDOUMsNENBQW9DO0FBQ3BDLDhDQUFzQztBQUN0Qzs7RUFFRTtBQUNGO0lBV0ksZ0JBQWMsQ0FBQztJQUNmLE1BQU0sQ0FBQyxJQUFJO1FBQ1AsSUFBSSxHQUFHLEdBQWEsSUFBSSxDQUFDLFVBQVUsQ0FBQyxRQUFRLENBQUM7UUFDN0MsR0FBRyxDQUFDLGtCQUFrQixFQUFDLGdCQUFNLENBQUMsQ0FBQztRQUMvQixHQUFHLENBQUMsdUJBQXVCLEVBQUMscUJBQVcsQ0FBQyxDQUFDO1FBQ3pDLEdBQUcsQ0FBQyxrQkFBa0IsRUFBQyxnQkFBTSxDQUFDLENBQUM7UUFDL0IsR0FBRyxDQUFDLG1CQUFtQixFQUFDLGlCQUFPLENBQUMsQ0FBQztJQUNyQyxDQUFDOztBQWpCTSxnQkFBSyxHQUFR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QUFBO0lBQ0wsQ0FBQyxFQVZnQixJQUFJLEdBQUosT0FBSSxLQUFKLE9BQUksUUFVcEI7QUFBRCxDQUFDLEVBVmEsRUFBRSxHQUFGLFVBQUUsS0FBRixVQUFFLFFBVWYiLCJmaWxlIjoiZ2VuZXJhdGVkLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXNDb250ZW50IjpbInZhciBfX2V4dGVuZHMgPSAodGhpcyAmJiB0aGlzLl9fZXh0ZW5kcykgfHwgKGZ1bmN0aW9uICgpIHtcclxuICAgIHZhciBleHRlbmRTdGF0aWNzID0gT2JqZWN0LnNldFByb3RvdHlwZU9mIHx8XHJcbiAgICAgICAgKHsgX19wcm90b19fOiBbXSB9IGluc3RhbmNlb2YgQXJyYXkgJiYgZnVuY3Rpb24gKGQsIGIpIHsgZC5fX3Byb3RvX18gPSBiOyB9KSB8fFxyXG4gICAgICAgIGZ1bmN0aW9uIChkLCBiKSB7IGZvciAodmFyIHAgaW4gYikgaWYgKGIuaGFzT3duUHJvcGVydHkocCkpIGRbcF0gPSBiW3BdOyB9O1xyXG4gICAgcmV0dXJuIGZ1bmN0aW9uIChkLCBiKSB7XHJcbiAgICAgICAgZXh0ZW5kU3RhdGljcyhkLCBiKTtcclxuICAgICAgICBmdW5jdGlvbiBfXygpIHsgdGhpcy5jb25zdHJ1Y3RvciA9IGQ7IH1cclxuICAgICAgICBkLnByb3RvdHlwZSA9IGIgPT09IG51bGwgPyBPYmplY3QuY3JlYXRlKGIpIDogKF9fLnByb3RvdHlwZSA9IGIucHJvdG90eXBlLCBuZXcgX18oKSk7XHJcbiAgICB9O1xyXG59KSgpO1xyXG4oZnVuY3Rpb24oKXtmdW5jdGlvbiByKGUsbix0KXtmdW5jdGlvbiBvKGksZil7aWYoIW5baV0pe2lmKCFlW2ldKXt2YXIgYz1cImZ1bmN0aW9uXCI9PXR5cGVvZiByZXF1aXJlJiZyZXF1aXJlO2lmKCFmJiZjKXJldHVybiBjKGksITApO2lmKHUpcmV0dXJuIHUoaSwhMCk7dmFyIGE9bmV3IEVycm9yKFwiQ2Fubm90IGZpbmQgbW9kdWxlICdcIitpK1wiJ1wiKTt0aHJvdyBhLmNvZGU9XCJNT0RVTEVfTk9UX0ZPVU5EXCIsYX12YXIgcD1uW2ldPXtleHBvcnRzOnt9fTtlW2ldWzBdLmNhbGwocC5leHBvcnRzLGZ1bmN0aW9uKHIpe3ZhciBuPWVbaV1bMV1bcl07cmV0dXJuIG8obnx8cil9LHAscC5leHBvcnRzLHIsZSxuLHQpfXJldHVybiBuW2ldLmV4cG9ydHN9Zm9yKHZhciB1PVwiZnVuY3Rpb25cIj09dHlwZW9mIHJlcXVpcmUmJnJlcXVpcmUsaT0wO2k8dC5sZW5ndGg7aSsrKW8odFtpXSk7cmV0dXJuIG99cmV0dXJuIHJ9KSgpIiwiIWZ1bmN0aW9uKHQsZSl7XCJvYmplY3RcIj09dHlwZW9mIGV4cG9ydHMmJlwidW5kZWZpbmVkXCIhPXR5cGVvZiBtb2R1bGU/ZShleHBvcnRzKTpcImZ1bmN0aW9uXCI9PXR5cGVvZiBkZWZpbmUmJmRlZmluZS5hbWQ/ZGVmaW5lKFtcImV4cG9ydHNcIl0sZSk6ZSh0LmFzaD17fSl9KHRoaXMsZnVuY3Rpb24odCl7XCJ1c2Ugc3RyaWN0XCI7Y2xhc3MgZXtjb25zdHJ1Y3Rvcigpe3RoaXMucHJldmlvdXM9bnVsbCx0aGlzLm5leHQ9bnVsbCx0aGlzLmxpc3RlbmVyPW51bGwsdGhpcy5vbmNlPSExfX1jbGFzcyBze2NvbnN0cnVjdG9yKCl7dGhpcy50YWlsPW51bGwsdGhpcy5jYWNoZVRhaWw9bnVsbH1nZXQoKXtpZih0aGlzLnRhaWwpe2NvbnN0IHQ9dGhpcy50YWlsO3JldHVybiB0aGlzLnRhaWw9dGhpcy50YWlsLnByZXZpb3VzLHQucHJldmlvdXM9bnVsbCx0fXJldHVybiBuZXcgZX1kaXNwb3NlKHQpe3QubGlzdGVuZXI9bnVsbCx0Lm9uY2U9ITEsdC5uZXh0PW51bGwsdC5wcmV2aW91cz10aGlzLnRhaWwsdGhpcy50YWlsPXR9Y2FjaGUodCl7dC5saXN0ZW5lcj1udWxsLHQucHJldmlvdXM9dGhpcy5jYWNoZVRhaWwsdGhpcy5jYWNoZVRhaWw9dH1yZWxlYXNlQ2FjaGUoKXtmb3IoO3RoaXMuY2FjaGVUYWlsOyl7Y29uc3QgdD10aGlzLmNhY2hlVGFpbDt0aGlzLmNhY2hlVGFpbD10LnByZXZpb3VzLHQubmV4dD1udWxsLHQucHJldmlvdXM9dGhpcy50YWlsLHRoaXMudGFpbD10fX19Y2xhc3MgaXtjb25zdHJ1Y3Rvcigpe3RoaXMuaGVhZD1udWxsLHRoaXMudGFpbD1udWxsLHRoaXMudG9BZGRIZWFkPW51bGwsdGhpcy50b0FkZFRhaWw9bnVsbCx0aGlzLmRpc3BhdGNoaW5nPSExLHRoaXMucE51bUxpc3RlbmVycz0wLHRoaXMubm9kZXM9bmV3IE1hcCx0aGlzLmxpc3RlbmVyTm9kZVBvb2w9bmV3IHN9c3RhcnREaXNwYXRjaCgpe3RoaXMuZGlzcGF0Y2hpbmc9ITB9ZW5kRGlzcGF0Y2goKXt0aGlzLmRpc3BhdGNoaW5nPSExLHRoaXMudG9BZGRIZWFkJiYodGhpcy5oZWFkPyh0aGlzLnRhaWwubmV4dD10aGlzLnRvQWRkSGVhZCx0aGlzLnRvQWRkSGVhZC5wcmV2aW91cz10aGlzLnRhaWwsdGhpcy50YWlsPXRoaXMudG9BZGRUYWlsKToodGhpcy5oZWFkPXRoaXMudG9BZGRIZWFkLHRoaXMudGFpbD10aGlzLnRvQWRkVGFpbCksdGhpcy50b0FkZEhlYWQ9bnVsbCx0aGlzLnRvQWRkVGFpbD1udWxsKSx0aGlzLmxpc3RlbmVyTm9kZVBvb2wucmVsZWFzZUNhY2hlKCl9Z2V0IG51bUxpc3RlbmVycygpe3JldHVybiB0aGlzLnBOdW1MaXN0ZW5lcnN9YWRkKHQpe2lmKHRoaXMubm9kZXMuaGFzKHQpKXJldHVybjtjb25zdCBlPXRoaXMubGlzdGVuZXJOb2RlUG9vbC5nZXQoKTtlLmxpc3RlbmVyPXQsdGhpcy5ub2Rlcy5zZXQodCxlKSx0aGlzLmFkZE5vZGUoZSl9YWRkT25jZSh0KXtpZih0aGlzLm5vZGVzLmhhcyh0KSlyZXR1cm47Y29uc3QgZT10aGlzLmxpc3RlbmVyTm9kZVBvb2wuZ2V0KCk7ZS5saXN0ZW5lcj10LGUub25jZT0hMCx0aGlzLm5vZGVzLnNldCh0LGUpLHRoaXMuYWRkTm9kZShlKX1hZGROb2RlKHQpe3RoaXMuZGlzcGF0Y2hpbmc/dGhpcy50b0FkZEhlYWQ/KHRoaXMudG9BZGRUYWlsLm5leHQ9dCx0LnByZXZpb3VzPXRoaXMudG9BZGRUYWlsLHRoaXMudG9BZGRUYWlsPXQpOnRoaXMudG9BZGRIZWFkPXRoaXMudG9BZGRUYWlsPXQ6dGhpcy5oZWFkPyh0aGlzLnRhaWwubmV4dD10LHQucHJldmlvdXM9dGhpcy50YWlsLHRoaXMudGFpbD10KTp0aGlzLmhlYWQ9dGhpcy50YWlsPXQsdGhpcy5wTnVtTGlzdGVuZXJzKz0xfXJlbW92ZSh0KXtjb25zdCBlPXRoaXMubm9kZXMuZ2V0KHQpfHxudWxsO2UmJih0aGlzLmhlYWQ9PT1lJiYodGhpcy5oZWFkPXRoaXMuaGVhZC5uZXh0KSx0aGlzLnRhaWw9PT1lJiYodGhpcy50YWlsPXRoaXMudGFpbC5wcmV2aW91cyksdGhpcy50b0FkZEhlYWQ9PT1lJiYodGhpcy50b0FkZEhlYWQ9dGhpcy50b0FkZEhlYWQubmV4dCksdGhpcy50b0FkZFRhaWw9PT1lJiYodGhpcy50b0FkZFRhaWw9dGhpcy50b0FkZFRhaWwucHJldmlvdXMpLGUucHJldmlvdXMmJihlLnByZXZpb3VzLm5leHQ9ZS5uZXh0KSxlLm5leHQmJihlLm5leHQucHJldmlvdXM9ZS5wcmV2aW91cyksdGhpcy5ub2Rlcy5kZWxldGUodCksdGhpcy5kaXNwYXRjaGluZz90aGlzLmxpc3RlbmVyTm9kZVBvb2wuY2FjaGUoZSk6dGhpcy5saXN0ZW5lck5vZGVQb29sLmRpc3Bvc2UoZSksdGhpcy5wTnVtTGlzdGVuZXJzLT0xKX1yZW1vdmVBbGwoKXtmb3IoO3RoaXMuaGVhZDspe2NvbnN0IHQ9dGhpcy5oZWFkO3RoaXMuaGVhZD10aGlzLmhlYWQubmV4dCx0aGlzLm5vZGVzLmRlbGV0ZSh0Lmxpc3RlbmVyKSx0aGlzLmxpc3RlbmVyTm9kZVBvb2wuZGlzcG9zZSh0KX10aGlzLnRhaWw9bnVsbCx0aGlzLnRvQWRkSGVhZD1udWxsLHRoaXMudG9BZGRUYWlsPW51bGwsdGhpcy5wTnVtTGlzdGVuZXJzPTB9fWNsYXNzIG4gZXh0ZW5kcyBpe2Rpc3BhdGNoKCl7bGV0IHQ7Zm9yKHRoaXMuc3RhcnREaXNwYXRjaCgpLHQ9dGhpcy5oZWFkO3Q7dD10Lm5leHQpdC5saXN0ZW5lci5jYWxsKHQpLHQub25jZSYmdGhpcy5yZW1vdmUodC5saXN0ZW5lcik7dGhpcy5lbmREaXNwYXRjaCgpfX1jbGFzcyBvIGV4dGVuZHMgaXtkaXNwYXRjaCh0KXtsZXQgZTtmb3IodGhpcy5zdGFydERpc3BhdGNoKCksZT10aGlzLmhlYWQ7ZTtlPWUubmV4dCllLmxpc3RlbmVyLmNhbGwoZSx0KSxlLm9uY2UmJnRoaXMucmVtb3ZlKGUubGlzdGVuZXIpO3RoaXMuZW5kRGlzcGF0Y2goKX19Y2xhc3MgaCBleHRlbmRzIGl7ZGlzcGF0Y2godCxlKXtsZXQgcztmb3IodGhpcy5zdGFydERpc3BhdGNoKCkscz10aGlzLmhlYWQ7cztzPXMubmV4dClzLmxpc3RlbmVyLmNhbGwocyx0LGUpLHMub25jZSYmdGhpcy5yZW1vdmUocy5saXN0ZW5lcik7dGhpcy5lbmREaXNwYXRjaCgpfX1jbGFzcyBye2NvbnN0cnVjdG9yKCl7dGhpcy5oZWFkPW51bGwsdGhpcy50YWlsPW51bGwsdGhpcy5ub2RlQWRkZWQ9bmV3IG8sdGhpcy5ub2RlUmVtb3ZlZD1uZXcgb31hZGQodCl7dGhpcy5oZWFkPyh0aGlzLnRhaWwubmV4dD10LHQucHJldmlvdXM9dGhpcy50YWlsLHQubmV4dD1udWxsLHRoaXMudGFpbD10KToodGhpcy5oZWFkPXRoaXMudGFpbD10LHQubmV4dD10LnByZXZpb3VzPW51bGwpLHRoaXMubm9kZUFkZGVkLmRpc3BhdGNoKHQpfXJlbW92ZSh0KXt0aGlzLmhlYWQ9PT10JiYodGhpcy5oZWFkPXRoaXMuaGVhZC5uZXh0KSx0aGlzLnRhaWw9PT10JiYodGhpcy50YWlsPXRoaXMudGFpbC5wcmV2aW91cyksdC5wcmV2aW91cyYmKHQucHJldmlvdXMubmV4dD10Lm5leHQpLHQubmV4dCYmKHQubmV4dC5wcmV2aW91cz10LnByZXZpb3VzKSx0aGlzLm5vZGVSZW1vdmVkLmRpc3BhdGNoKHQpfXJlbW92ZUFsbCgpe2Zvcig7dGhpcy5oZWFkOyl7Y29uc3QgdD10aGlzLmhlYWQ7dGhpcy5oZWFkPXQubmV4dCx0LnByZXZpb3VzPW51bGwsdC5uZXh0PW51bGwsdGhpcy5ub2RlUmVtb3ZlZC5kaXNwYXRjaCh0KX10aGlzLnRhaWw9bnVsbH1nZXQgZW1wdHkoKXtyZXR1cm4gbnVsbD09dGhpcy5oZWFkfXN3YXAodCxlKXtpZih0LnByZXZpb3VzPT09ZSl0LnByZXZpb3VzPWUucHJldmlvdXMsZS5wcmV2aW91cz10LGUubmV4dD10Lm5leHQsdC5uZXh0PWU7ZWxzZSBpZihlLnByZXZpb3VzPT09dCllLnByZXZpb3VzPXQucHJldmlvdXMsdC5wcmV2aW91cz1lLHQubmV4dD1lLm5leHQsZS5uZXh0PXQ7ZWxzZXtsZXQgcz10LnByZXZpb3VzO3QucHJldmlvdXM9ZS5wcmV2aW91cyxlLnByZXZpb3VzPXMscz10Lm5leHQsdC5uZXh0PWUubmV4dCxlLm5leHQ9c310aGlzLmhlYWQ9PT10P3RoaXMuaGVhZD1lOnRoaXMuaGVhZD09PWUmJih0aGlzLmhlYWQ9dCksdGhpcy50YWlsPT09dD90aGlzLnRhaWw9ZTp0aGlzLnRhaWw9PT1lJiYodGhpcy50YWlsPXQpLHQucHJldmlvdXMmJih0LnByZXZpb3VzLm5leHQ9dCksZS5wcmV2aW91cyYmKGUucHJldmlvdXMubmV4dD1lKSx0Lm5leHQmJih0Lm5leHQucHJldmlvdXM9dCksZS5uZXh0JiYoZS5uZXh0LnByZXZpb3VzPWUpfWluc2VydGlvblNvcnQodCl7aWYodGhpcy5oZWFkPT09dGhpcy50YWlsKXJldHVybjtsZXQgZT10aGlzLmhlYWQubmV4dDtmb3IobGV0IHM9ZTtzO3M9ZSl7bGV0IGk7Zm9yKGU9cy5uZXh0LGk9cy5wcmV2aW91cztpO2k9aS5wcmV2aW91cylpZih0KHMsaSk+PTApe3MhPT1pLm5leHQmJih0aGlzLnRhaWw9PT1zJiYodGhpcy50YWlsPXMucHJldmlvdXMpLHMucHJldmlvdXMubmV4dD1zLm5leHQscy5uZXh0JiYocy5uZXh0LnByZXZpb3VzPXMucHJldmlvdXMpLHMubmV4dD1pLm5leHQscy5wcmV2aW91cz1pLHMubmV4dC5wcmV2aW91cz1zLGkubmV4dD1zKTticmVha31pfHwodGhpcy50YWlsPT09cyYmKHRoaXMudGFpbD1zLnByZXZpb3VzKSxzLnByZXZpb3VzLm5leHQ9cy5uZXh0LHMubmV4dCYmKHMubmV4dC5wcmV2aW91cz1zLnByZXZpb3VzKSxzLm5leHQ9dGhpcy5oZWFkLHRoaXMuaGVhZC5wcmV2aW91cz1zLHMucHJldmlvdXM9bnVsbCx0aGlzLmhlYWQ9cyl9fW1lcmdlU29ydCh0KXtpZih0aGlzLmhlYWQ9PT10aGlzLnRhaWwpcmV0dXJuO2NvbnN0IGU9W107bGV0IHMsaT10aGlzLmhlYWQ7Zm9yKDtpOyl7Zm9yKHM9aTtzLm5leHQmJnQocyxzLm5leHQpPD0wOylzPXMubmV4dDtjb25zdCBuPXMubmV4dDtpLnByZXZpb3VzPXMubmV4dD1udWxsLGVbZS5sZW5ndGhdPWksaT1ufWZvcig7ZS5sZW5ndGg+MTspZS5wdXNoKHRoaXMubWVyZ2UoZS5zaGlmdCgpLGUuc2hpZnQoKSx0KSk7Zm9yKHRoaXMudGFpbD10aGlzLmhlYWQ9ZVswXTt0aGlzLnRhaWwubmV4dDspdGhpcy50YWlsPXRoaXMudGFpbC5uZXh0fW1lcmdlKHQsZSxzKXtsZXQgaSxuO2ZvcihzKHQsZSk8PTA/KG49aT10LHQ9dC5uZXh0KToobj1pPWUsZT1lLm5leHQpO3QmJmU7KXModCxlKTw9MD8oaS5uZXh0PXQsdC5wcmV2aW91cz1pLGk9dCx0PXQubmV4dCk6KGkubmV4dD1lLGUucHJldmlvdXM9aSxpPWUsZT1lLm5leHQpO3JldHVybiB0PyhpLm5leHQ9dCx0LnByZXZpb3VzPWkpOihpLm5leHQ9ZSxlLnByZXZpb3VzPWkpLG59fWNsYXNzIGF7Y29uc3RydWN0b3IodCxlKXt0aGlzLnRhaWw9bnVsbCx0aGlzLmNhY2hlVGFpbD1udWxsLHRoaXMubm9kZUNsYXNzPXQsdGhpcy5jb21wb25lbnRzPWV9Z2V0KCl7aWYodGhpcy50YWlsKXtjb25zdCB0PXRoaXMudGFpbDtyZXR1cm4gdGhpcy50YWlsPXRoaXMudGFpbC5wcmV2aW91cyx0LnByZXZpb3VzPW51bGwsdH1yZXR1cm4gbmV3IHRoaXMubm9kZUNsYXNzfWRpc3Bvc2UodCl7Zm9yKGNvbnN0IGUgb2YgdGhpcy5jb21wb25lbnRzLnZhbHVlcygpKXRbZV09bnVsbDt0LmVudGl0eT1udWxsLHQubmV4dD1udWxsLHQucHJldmlvdXM9dGhpcy50YWlsLHRoaXMudGFpbD10fWNhY2hlKHQpe3QucHJldmlvdXM9dGhpcy5jYWNoZVRhaWwsdGhpcy5jYWNoZVRhaWw9dH1yZWxlYXNlQ2FjaGUoKXtmb3IoO3RoaXMuY2FjaGVUYWlsOyl7Y29uc3QgdD10aGlzLmNhY2hlVGFpbDt0aGlzLmNhY2hlVGFpbD10LnByZXZpb3VzLHRoaXMuZGlzcG9zZSh0KX19fWNvbnN0IGQ9XCJfX2FzaF90eXBlc19fXCI7Y2xhc3MgbHtjb25zdHJ1Y3Rvcih0LGUpe3RoaXMucmVsZWFzZU5vZGVQb29sQ2FjaGU9KCgpPT57dGhpcy5lbmdpbmUudXBkYXRlQ29tcGxldGUucmVtb3ZlKHRoaXMucmVsZWFzZU5vZGVQb29sQ2FjaGUpLHRoaXMubm9kZVBvb2wucmVsZWFzZUNhY2hlKCl9KSx0aGlzLm5vZGVDbGFzcz10LHRoaXMuZW5naW5lPWUsdGhpcy5pbml0KCl9aW5pdCgpe3RoaXMubm9kZXM9bmV3IHIsdGhpcy5lbnRpdGllcz1uZXcgTWFwLHRoaXMuY29tcG9uZW50cz1uZXcgTWFwLHRoaXMubm9kZVBvb2w9bmV3IGEodGhpcy5ub2RlQ2xhc3MsdGhpcy5jb21wb25lbnRzKTtjb25zdCB0PXRoaXMubm9kZVBvb2wuZ2V0KCk7dGhpcy5ub2RlUG9vbC5kaXNwb3NlKHQpO2NvbnN0IGU9dC5jb25zdHJ1Y3RvcltkXTtmb3IoY29uc3RbdCxzXW9mIGUpdGhpcy5jb21wb25lbnRzLnNldChzLHQpfWdldCBub2RlTGlzdCgpe3JldHVybiB0aGlzLm5vZGVzfW5ld0VudGl0eSh0KXt0aGlzLmFkZElmTWF0Y2godCl9Y29tcG9uZW50QWRkZWRUb0VudGl0eSh0LGUpe3RoaXMuYWRkSWZNYXRjaCh0KX1jb21wb25lbnRSZW1vdmVkRnJvbUVudGl0eSh0LGUpe3RoaXMuY29tcG9uZW50cy5oYXMoZSkmJnRoaXMucmVtb3ZlSWZNYXRjaCh0KX1yZW1vdmVFbnRpdHkodCl7dGhpcy5yZW1vdmVJZk1hdGNoKHQpfWFkZElmTWF0Y2godCl7aWYoIXRoaXMuZW50aXRpZXMuaGFzKHQpKXtmb3IoY29uc3QgZSBvZiB0aGlzLmNvbXBvbmVudHMua2V5cygpKWlmKCF0LmhhcyhlKSlyZXR1cm47Y29uc3QgZT10aGlzLm5vZGVQb29sLmdldCgpO2UuZW50aXR5PXQ7Zm9yKGNvbnN0IHMgb2YgdGhpcy5jb21wb25lbnRzLmtleXMoKSllW3RoaXMuY29tcG9uZW50cy5nZXQocyldPXQuZ2V0KHMpO3RoaXMuZW50aXRpZXMuc2V0KHQsZSksdGhpcy5ub2Rlcy5hZGQoZSl9fXJlbW92ZUlmTWF0Y2godCl7aWYodGhpcy5lbnRpdGllcy5oYXModCkpe2NvbnN0IGU9dGhpcy5lbnRpdGllcy5nZXQodCk7dGhpcy5lbnRpdGllcy5kZWxldGUodCksdGhpcy5ub2Rlcy5yZW1vdmUoZSksdGhpcy5lbmdpbmUudXBkYXRpbmc/KHRoaXMubm9kZVBvb2wuY2FjaGUoZSksdGhpcy5lbmdpbmUudXBkYXRlQ29tcGxldGUuYWRkKHRoaXMucmVsZWFzZU5vZGVQb29sQ2FjaGUpKTp0aGlzLm5vZGVQb29sLmRpc3Bvc2UoZSl9fWNsZWFuVXAoKXtmb3IobGV0IHQ9dGhpcy5ub2Rlcy5oZWFkO3Q7dD10Lm5leHQpdGhpcy5lbnRpdGllcy5kZWxldGUodC5lbnRpdHkpO3RoaXMubm9kZXMucmVtb3ZlQWxsKCl9fWNsYXNzIGN7Y29uc3RydWN0b3IoKXt0aGlzLmhlYWQ9bnVsbCx0aGlzLnRhaWw9bnVsbH1hZGQodCl7dGhpcy5oZWFkPyh0aGlzLnRhaWwubmV4dD10LHQucHJldmlvdXM9dGhpcy50YWlsLHQubmV4dD1udWxsLHRoaXMudGFpbD10KToodGhpcy5oZWFkPXRoaXMudGFpbD10LHQubmV4dD10LnByZXZpb3VzPW51bGwpfXJlbW92ZSh0KXt0aGlzLmhlYWQ9PT10JiYodGhpcy5oZWFkPXRoaXMuaGVhZC5uZXh0KSx0aGlzLnRhaWw9PT10JiYodGhpcy50YWlsPXRoaXMudGFpbC5wcmV2aW91cyksdC5wcmV2aW91cyYmKHQucHJldmlvdXMubmV4dD10Lm5leHQpLHQubmV4dCYmKHQubmV4dC5wcmV2aW91cz10LnByZXZpb3VzKX1yZW1vdmVBbGwoKXtmb3IoO3RoaXMuaGVhZDspe2NvbnN0IHQ9dGhpcy5oZWFkO3RoaXMuaGVhZD10aGlzLmhlYWQubmV4dCx0LnByZXZpb3VzPW51bGwsdC5uZXh0PW51bGx9dGhpcy50YWlsPW51bGx9fWNsYXNzIHV7Y29uc3RydWN0b3IoKXt0aGlzLmhlYWQ9bnVsbCx0aGlzLnRhaWw9bnVsbH1hZGQodCl7aWYodGhpcy5oZWFkKXtsZXQgZTtmb3IoZT10aGlzLnRhaWw7ZSYmIShlLnByaW9yaXR5PD10LnByaW9yaXR5KTtlPWUucHJldmlvdXMpO2U9PT10aGlzLnRhaWw/KHRoaXMudGFpbC5uZXh0PXQsdC5wcmV2aW91cz10aGlzLnRhaWwsdC5uZXh0PW51bGwsdGhpcy50YWlsPXQpOmU/KHQubmV4dD1lLm5leHQsdC5wcmV2aW91cz1lLGUubmV4dC5wcmV2aW91cz10LGUubmV4dD10KToodC5uZXh0PXRoaXMuaGVhZCx0LnByZXZpb3VzPW51bGwsdGhpcy5oZWFkLnByZXZpb3VzPXQsdGhpcy5oZWFkPXQpfWVsc2UgdGhpcy5oZWFkPXRoaXMudGFpbD10LHQubmV4dD10LnByZXZpb3VzPW51bGx9cmVtb3ZlKHQpe3RoaXMuaGVhZD09PXQmJih0aGlzLmhlYWQ9dGhpcy5oZWFkLm5leHQpLHRoaXMudGFpbD09PXQmJih0aGlzLnRhaWw9dGhpcy50YWlsLnByZXZpb3VzKSx0LnByZXZpb3VzJiYodC5wcmV2aW91cy5uZXh0PXQubmV4dCksdC5uZXh0JiYodC5uZXh0LnByZXZpb3VzPXQucHJldmlvdXMpfXJlbW92ZUFsbCgpe2Zvcig7dGhpcy5oZWFkOyl7Y29uc3QgdD10aGlzLmhlYWQ7dGhpcy5oZWFkPXRoaXMuaGVhZC5uZXh0LHQucHJldmlvdXM9bnVsbCx0Lm5leHQ9bnVsbH10aGlzLnRhaWw9bnVsbH1nZXQodCl7Zm9yKGxldCBlPXRoaXMuaGVhZDtlO2U9ZS5uZXh0KWlmKGUgaW5zdGFuY2VvZiB0KXJldHVybiBlO3JldHVybiBudWxsfX1jbGFzcyBwe2NvbnN0cnVjdG9yKHQ9XCJcIil7dGhpcy5wcmV2aW91cz1udWxsLHRoaXMubmV4dD1udWxsLHRoaXMuY29tcG9uZW50QWRkZWQ9bmV3IGgsdGhpcy5jb21wb25lbnRSZW1vdmVkPW5ldyBoLHRoaXMubmFtZUNoYW5nZWQ9bmV3IGgsdGhpcy5jb21wb25lbnRzPW5ldyBNYXAsdD90aGlzLnBOYW1lPXQ6KHAubmFtZUNvdW50Kz0xLHRoaXMucE5hbWU9XCJfZW50aXR5XCIrcC5uYW1lQ291bnQpfWdldCBuYW1lKCl7cmV0dXJuIHRoaXMucE5hbWV9c2V0IG5hbWUodCl7aWYodGhpcy5wTmFtZSE9PXQpe2NvbnN0IGU9dGhpcy5wTmFtZTt0aGlzLnBOYW1lPXQsdGhpcy5uYW1lQ2hhbmdlZC5kaXNwYXRjaCh0aGlzLGUpfX1hZGQodCxlPW51bGwpe3JldHVybiBlfHwoZT10LmNvbnN0cnVjdG9yLnByb3RvdHlwZS5jb25zdHJ1Y3RvciksZT1lLHRoaXMuY29tcG9uZW50cy5oYXMoZSkmJnRoaXMucmVtb3ZlKGUpLHRoaXMuY29tcG9uZW50cy5zZXQoZSx0KSx0aGlzLmNvbXBvbmVudEFkZGVkLmRpc3BhdGNoKHRoaXMsZSksdGhpc31yZW1vdmUodCl7Y29uc3QgZT10aGlzLmNvbXBvbmVudHMuZ2V0KHQpO3JldHVybiBlPyh0aGlzLmNvbXBvbmVudHMuZGVsZXRlKHQpLHRoaXMuY29tcG9uZW50UmVtb3ZlZC5kaXNwYXRjaCh0aGlzLHQpLGUpOm51bGx9Z2V0KHQpe3JldHVybiB0aGlzLmNvbXBvbmVudHMuZ2V0KHQpfWdldEFsbCgpe2NvbnN0IHQ9W107Zm9yKGNvbnN0IGUgb2YgdGhpcy5jb21wb25lbnRzLnZhbHVlcygpKXRbdC5sZW5ndGhdPWU7cmV0dXJuIHR9aGFzKHQpe3JldHVybiB0aGlzLmNvbXBvbmVudHMuaGFzKHQpfX1wLm5hbWVDb3VudD0wO2NsYXNzIG17Y29uc3RydWN0b3IoKXt0aGlzLnByZXZpb3VzPW51bGwsdGhpcy5uZXh0PW51bGwsdGhpcy5wcmlvcml0eT0wfX1jbGFzcyB2e2NvbnN0cnVjdG9yKHQpe3RoaXMuaW5zdGFuY2U9dH1nZXRDb21wb25lbnQoKXtyZXR1cm4gdGhpcy5pbnN0YW5jZX1nZXQgaWRlbnRpZmllcigpe3JldHVybiB0aGlzLmluc3RhbmNlfX1jbGFzcyB5e2NvbnN0cnVjdG9yKHQpe3RoaXMuY29tcG9uZW50VHlwZT10fWdldENvbXBvbmVudCgpe3JldHVybiB0aGlzLmluc3RhbmNlfHwodGhpcy5pbnN0YW5jZT1uZXcgdGhpcy5jb21wb25lbnRUeXBlKSx0aGlzLmluc3RhbmNlfWdldCBpZGVudGlmaWVyKCl7cmV0dXJuIHRoaXMuZ2V0Q29tcG9uZW50KCl9fWNsYXNzIGZ7Y29uc3RydWN0b3IodCl7dGhpcy5jb21wb25lbnRUeXBlPXR9Z2V0Q29tcG9uZW50KCl7cmV0dXJuIG5ldyB0aGlzLmNvbXBvbmVudFR5cGV9Z2V0IGlkZW50aWZpZXIoKXtyZXR1cm4gdGhpcy5jb21wb25lbnRUeXBlfX1jbGFzcyBne2NvbnN0cnVjdG9yKHQpe3RoaXMuY2xvc3VyZT10fWdldENvbXBvbmVudCgpe3JldHVybiB0aGlzLmNsb3N1cmUoKX1nZXQgaWRlbnRpZmllcigpe3JldHVybiB0aGlzLmNsb3N1cmV9fWNsYXNzIHh7Y29uc3RydWN0b3IodCxlKXt0aGlzLmNyZWF0aW5nU3RhdGU9dCx0aGlzLmNvbXBvbmVudFR5cGU9ZSx0aGlzLndpdGhUeXBlKGUpfXdpdGhJbnN0YW5jZSh0KXtyZXR1cm4gdGhpcy5zZXRQcm92aWRlcihuZXcgdih0KSksdGhpc313aXRoVHlwZSh0KXtyZXR1cm4gdGhpcy5zZXRQcm92aWRlcihuZXcgZih0KSksdGhpc313aXRoU2luZ2xldG9uKHQpe3JldHVybiB0fHwodD10aGlzLmNvbXBvbmVudFR5cGUpLHRoaXMuc2V0UHJvdmlkZXIobmV3IHkodCkpLHRoaXN9d2l0aE1ldGhvZCh0KXtyZXR1cm4gdGhpcy5zZXRQcm92aWRlcihuZXcgZyh0KSksdGhpc313aXRoUHJvdmlkZXIodCl7cmV0dXJuIHRoaXMuc2V0UHJvdmlkZXIodCksdGhpc31hZGQodCl7cmV0dXJuIHRoaXMuY3JlYXRpbmdTdGF0ZS5hZGQodCl9c2V0UHJvdmlkZXIodCl7dGhpcy5wcm92aWRlcj10LHRoaXMuY3JlYXRpbmdTdGF0ZS5wcm92aWRlcnMuc2V0KHRoaXMuY29tcG9uZW50VHlwZSx0KX19Y2xhc3Mgd3tjb25zdHJ1Y3Rvcigpe3RoaXMucHJvdmlkZXJzPW5ldyBNYXB9YWRkKHQpe3JldHVybiBuZXcgeCh0aGlzLHQpfWdldCh0KXtyZXR1cm4gdGhpcy5wcm92aWRlcnMuZ2V0KHQpfHxudWxsfWhhcyh0KXtyZXR1cm4gdGhpcy5wcm92aWRlcnMuaGFzKHQpfX1jbGFzcyBBe2NvbnN0cnVjdG9yKHQpe3RoaXMuc3lzdGVtUHJpb3JpdHk9MCx0aGlzLm1ldGhvZD10fWdldFN5c3RlbSgpe3JldHVybiB0aGlzLm1ldGhvZCgpfWdldCBpZGVudGlmaWVyKCl7cmV0dXJuIHRoaXMubWV0aG9kfWdldCBwcmlvcml0eSgpe3JldHVybiB0aGlzLnN5c3RlbVByaW9yaXR5fXNldCBwcmlvcml0eSh0KXt0aGlzLnN5c3RlbVByaW9yaXR5PXR9fWNsYXNzIFR7Y29uc3RydWN0b3IodCxlKXt0aGlzLmNyZWF0aW5nU3RhdGU9dCx0aGlzLnByb3ZpZGVyPWV9d2l0aFByaW9yaXR5KHQpe3JldHVybiB0aGlzLnByb3ZpZGVyLnByaW9yaXR5PXQsdGhpc31hZGRJbnN0YW5jZSh0KXtyZXR1cm4gdGhpcy5jcmVhdGluZ1N0YXRlLmFkZEluc3RhbmNlKHQpfWFkZFNpbmdsZXRvbih0KXtyZXR1cm4gdGhpcy5jcmVhdGluZ1N0YXRlLmFkZFNpbmdsZXRvbih0KX1hZGRNZXRob2QodCl7cmV0dXJuIHRoaXMuY3JlYXRpbmdTdGF0ZS5hZGRNZXRob2QodCl9YWRkUHJvdmlkZXIodCl7cmV0dXJuIHRoaXMuY3JlYXRpbmdTdGF0ZS5hZGRQcm92aWRlcih0KX19Y2xhc3MgUHtjb25zdHJ1Y3Rvcih0KXt0aGlzLnN5c3RlbVByaW9yaXR5PTAsdGhpcy5pbnN0YW5jZT10fWdldFN5c3RlbSgpe3JldHVybiB0aGlzLmluc3RhbmNlfWdldCBpZGVudGlmaWVyKCl7cmV0dXJuIHRoaXMuaW5zdGFuY2V9Z2V0IHByaW9yaXR5KCl7cmV0dXJuIHRoaXMuc3lzdGVtUHJpb3JpdHl9c2V0IHByaW9yaXR5KHQpe3RoaXMuc3lzdGVtUHJpb3JpdHk9dH19Y2xhc3MgU3tjb25zdHJ1Y3Rvcih0KXt0aGlzLnN5c3RlbVByaW9yaXR5PTAsdGhpcy5jb21wb25lbnRUeXBlPXR9Z2V0U3lzdGVtKCl7cmV0dXJuIHRoaXMuaW5zdGFuY2V8fCh0aGlzLmluc3RhbmNlPW5ldyB0aGlzLmNvbXBvbmVudFR5cGUpLHRoaXMuaW5zdGFuY2V9Z2V0IGlkZW50aWZpZXIoKXtyZXR1cm4gdGhpcy5nZXRTeXN0ZW0oKX1nZXQgcHJpb3JpdHkoKXtyZXR1cm4gdGhpcy5zeXN0ZW1Qcmlvcml0eX1zZXQgcHJpb3JpdHkodCl7dGhpcy5zeXN0ZW1Qcmlvcml0eT10fX1jbGFzcyBOe2NvbnN0cnVjdG9yKCl7dGhpcy5wcm92aWRlcnM9W119YWRkSW5zdGFuY2UodCl7cmV0dXJuIHRoaXMuYWRkUHJvdmlkZXIobmV3IFAodCkpfWFkZFNpbmdsZXRvbih0KXtyZXR1cm4gdGhpcy5hZGRQcm92aWRlcihuZXcgUyh0KSl9YWRkTWV0aG9kKHQpe3JldHVybiB0aGlzLmFkZFByb3ZpZGVyKG5ldyBBKHQpKX1hZGRQcm92aWRlcih0KXtjb25zdCBlPW5ldyBUKHRoaXMsdCk7cmV0dXJuIHRoaXMucHJvdmlkZXJzW3RoaXMucHJvdmlkZXJzLmxlbmd0aF09dCxlfX1jbGFzcyBMe3N0YXRpYyBnZXRQb29sKHQpe2lmKEwucG9vbHMuaGFzKHQpKXJldHVybiBMLnBvb2xzLmdldCh0KTtjb25zdCBlPVtdO3JldHVybiBMLnBvb2xzLnNldCh0LGUpLGV9c3RhdGljIGdldCh0KXtjb25zdCBlPUwuZ2V0UG9vbCh0KTtyZXR1cm4gZS5sZW5ndGg+MD9lLnBvcCgpOm5ldyB0fXN0YXRpYyBkaXNwb3NlKHQpe2lmKHQpe2NvbnN0IGU9dC5jb25zdHJ1Y3Rvci5wcm90b3R5cGUuY29uc3RydWN0b3Iscz1MLmdldFBvb2woZSk7c1tzLmxlbmd0aF09dH19c3RhdGljIGVtcHR5KCl7TC5wb29scz1uZXcgTWFwfX1MLnBvb2xzPW5ldyBNYXA7dC5TaWduYWwwPW4sdC5TaWduYWwxPW8sdC5TaWduYWwyPWgsdC5TaWduYWwzPWNsYXNzIGV4dGVuZHMgaXtkaXNwYXRjaCh0LGUscyl7bGV0IGk7Zm9yKHRoaXMuc3RhcnREaXNwYXRjaCgpLGk9dGhpcy5oZWFkO2k7aT1pLm5leHQpaS5saXN0ZW5lci5jYWxsKGksdCxlLHMpLGkub25jZSYmdGhpcy5yZW1vdmUoaS5saXN0ZW5lcik7dGhpcy5lbmREaXNwYXRjaCgpfX0sdC5Db21wb25lbnRNYXRjaGluZ0ZhbWlseT1sLHQua2VlcD1mdW5jdGlvbih0KXtyZXR1cm4oZSxzKT0+e2NvbnN0IGk9ZS5jb25zdHJ1Y3RvcjtsZXQgbjtpLmhhc093blByb3BlcnR5KGQpP249aVtkXToobj1uZXcgTWFwLE9iamVjdC5kZWZpbmVQcm9wZXJ0eShpLGQse2VudW1lcmFibGU6ITAsZ2V0OigpPT5ufSkpLG4uc2V0KHMsdCl9fSx0LkVuZ2luZT1jbGFzc3tjb25zdHJ1Y3Rvcigpe3RoaXMudXBkYXRpbmc9ITEsdGhpcy5mYW1pbHlDbGFzcz1sLHRoaXMuZW50aXR5TmFtZUNoYW5nZWQ9KCh0LGUpPT57dGhpcy5lbnRpdHlOYW1lcy5nZXQoZSk9PT10JiYodGhpcy5lbnRpdHlOYW1lcy5kZWxldGUoZSksdGhpcy5lbnRpdHlOYW1lcy5zZXQodC5uYW1lLHQpKX0pLHRoaXMuY29tcG9uZW50QWRkZWQ9KCh0LGUpPT57Zm9yKGNvbnN0IHMgb2YgdGhpcy5mYW1pbGllcy52YWx1ZXMoKSlzLmNvbXBvbmVudEFkZGVkVG9FbnRpdHkodCxlKX0pLHRoaXMuY29tcG9uZW50UmVtb3ZlZD0oKHQsZSk9Pntmb3IoY29uc3QgcyBvZiB0aGlzLmZhbWlsaWVzLnZhbHVlcygpKXMuY29tcG9uZW50UmVtb3ZlZEZyb21FbnRpdHkodCxlKX0pLHRoaXMuZW50aXR5TGlzdD1uZXcgYyx0aGlzLmVudGl0eU5hbWVzPW5ldyBNYXAsdGhpcy5zeXN0ZW1MaXN0PW5ldyB1LHRoaXMuZmFtaWxpZXM9bmV3IE1hcCx0aGlzLnVwZGF0ZUNvbXBsZXRlPW5ldyBufWFkZEVudGl0eSh0KXtpZih0aGlzLmVudGl0eU5hbWVzLmhhcyh0Lm5hbWUpKXRocm93IG5ldyBFcnJvcihcIlRoZSBlbnRpdHkgbmFtZSBcIit0Lm5hbWUrXCIgaXMgYWxyZWFkeSBpbiB1c2UgYnkgYW5vdGhlciBlbnRpdHkuXCIpO3RoaXMuZW50aXR5TGlzdC5hZGQodCksdGhpcy5lbnRpdHlOYW1lcy5zZXQodC5uYW1lLHQpLHQuY29tcG9uZW50QWRkZWQuYWRkKHRoaXMuY29tcG9uZW50QWRkZWQpLHQuY29tcG9uZW50UmVtb3ZlZC5hZGQodGhpcy5jb21wb25lbnRSZW1vdmVkKSx0Lm5hbWVDaGFuZ2VkLmFkZCh0aGlzLmVudGl0eU5hbWVDaGFuZ2VkKTtmb3IoY29uc3QgZSBvZiB0aGlzLmZhbWlsaWVzLnZhbHVlcygpKWUubmV3RW50aXR5KHQpfXJlbW92ZUVudGl0eSh0KXt0LmNvbXBvbmVudEFkZGVkLnJlbW92ZSh0aGlzLmNvbXBvbmVudEFkZGVkKSx0LmNvbXBvbmVudFJlbW92ZWQucmVtb3ZlKHRoaXMuY29tcG9uZW50UmVtb3ZlZCksdC5uYW1lQ2hhbmdlZC5yZW1vdmUodGhpcy5lbnRpdHlOYW1lQ2hhbmdlZCk7Zm9yKGNvbnN0IGUgb2YgdGhpcy5mYW1pbGllcy52YWx1ZXMoKSllLnJlbW92ZUVudGl0eSh0KTt0aGlzLmVudGl0eU5hbWVzLmRlbGV0ZSh0Lm5hbWUpLHRoaXMuZW50aXR5TGlzdC5yZW1vdmUodCl9Z2V0RW50aXR5QnlOYW1lKHQpe3JldHVybiB0aGlzLmVudGl0eU5hbWVzLmdldCh0KXx8bnVsbH1yZW1vdmVBbGxFbnRpdGllcygpe2Zvcig7dGhpcy5lbnRpdHlMaXN0LmhlYWQ7KXRoaXMucmVtb3ZlRW50aXR5KHRoaXMuZW50aXR5TGlzdC5oZWFkKX1nZXQgZW50aXRpZXMoKXtjb25zdCB0PVtdO2ZvcihsZXQgZT10aGlzLmVudGl0eUxpc3QuaGVhZDtlO2U9ZS5uZXh0KXRbdC5sZW5ndGhdPWU7cmV0dXJuIHR9Z2V0Tm9kZUxpc3QodCl7aWYodGhpcy5mYW1pbGllcy5oYXModCkpcmV0dXJuIHRoaXMuZmFtaWxpZXMuZ2V0KHQpLm5vZGVMaXN0O2NvbnN0IGU9bmV3IHRoaXMuZmFtaWx5Q2xhc3ModCx0aGlzKTt0aGlzLmZhbWlsaWVzLnNldCh0LGUpO2ZvcihsZXQgdD10aGlzLmVudGl0eUxpc3QuaGVhZDt0O3Q9dC5uZXh0KWUubmV3RW50aXR5KHQpO3JldHVybiBlLm5vZGVMaXN0fXJlbGVhc2VOb2RlTGlzdCh0KXt0aGlzLmZhbWlsaWVzLmhhcyh0KSYmdGhpcy5mYW1pbGllcy5nZXQodCkuY2xlYW5VcCgpLHRoaXMuZmFtaWxpZXMuZGVsZXRlKHQpfWFkZFN5c3RlbSh0LGUpe3QucHJpb3JpdHk9ZSx0LmFkZFRvRW5naW5lKHRoaXMpLHRoaXMuc3lzdGVtTGlzdC5hZGQodCl9Z2V0U3lzdGVtKHQpe3JldHVybiB0aGlzLnN5c3RlbUxpc3QuZ2V0KHQpfWdldCBzeXN0ZW1zKCl7Y29uc3QgdD1bXTtmb3IobGV0IGU9dGhpcy5zeXN0ZW1MaXN0LmhlYWQ7ZTtlPWUubmV4dCl0W3QubGVuZ3RoXT1lO3JldHVybiB0fXJlbW92ZVN5c3RlbSh0KXt0aGlzLnN5c3RlbUxpc3QucmVtb3ZlKHQpLHQucmVtb3ZlRnJvbUVuZ2luZSh0aGlzKX1yZW1vdmVBbGxTeXN0ZW1zKCl7Zm9yKDt0aGlzLnN5c3RlbUxpc3QuaGVhZDspe2NvbnN0IHQ9dGhpcy5zeXN0ZW1MaXN0LmhlYWQ7dGhpcy5zeXN0ZW1MaXN0LmhlYWQ9dGhpcy5zeXN0ZW1MaXN0LmhlYWQubmV4dCx0LnByZXZpb3VzPW51bGwsdC5uZXh0PW51bGwsdC5yZW1vdmVGcm9tRW5naW5lKHRoaXMpfXRoaXMuc3lzdGVtTGlzdC50YWlsPW51bGx9dXBkYXRlKHQpe3RoaXMudXBkYXRpbmc9ITA7Zm9yKGxldCBlPXRoaXMuc3lzdGVtTGlzdC5oZWFkO2U7ZT1lLm5leHQpZS51cGRhdGUodCk7dGhpcy51cGRhdGluZz0hMSx0aGlzLnVwZGF0ZUNvbXBsZXRlLmRpc3BhdGNoKCl9fSx0LkVudGl0eT1wLHQuTm9kZT1jbGFzc3tjb25zdHJ1Y3Rvcigpe3RoaXMuZW50aXR5PW51bGwsdGhpcy5wcmV2aW91cz1udWxsLHRoaXMubmV4dD1udWxsfX0sdC5Ob2RlTGlzdD1yLHQuTm9kZVBvb2w9YSx0LlN5c3RlbT1tLHQuRW50aXR5U3RhdGVNYWNoaW5lPWNsYXNze2NvbnN0cnVjdG9yKHQpe3RoaXMuZW50aXR5PXQsdGhpcy5zdGF0ZXM9e319YWRkU3RhdGUodCxlKXtyZXR1cm4gdGhpcy5zdGF0ZXNbdF09ZSx0aGlzfWNyZWF0ZVN0YXRlKHQpe2NvbnN0IGU9bmV3IHc7cmV0dXJuIHRoaXMuc3RhdGVzW3RdPWUsZX1jaGFuZ2VTdGF0ZSh0KXtsZXQgZSxzPXRoaXMuc3RhdGVzW3RdO2lmKCFzKXRocm93IG5ldyBFcnJvcihgRW50aXR5IHN0YXRlICR7dH0gZG9lc24ndCBleGlzdGApO2lmKHMhPT10aGlzLmN1cnJlbnRTdGF0ZSl7aWYodGhpcy5jdXJyZW50U3RhdGUpe2U9bmV3IE1hcDtmb3IoY29uc3QgdCBvZiBzLnByb3ZpZGVycy5rZXlzKCkpZS5zZXQodCxzLnByb3ZpZGVycy5nZXQodCkpO2Zvcihjb25zdCB0IG9mIHRoaXMuY3VycmVudFN0YXRlLnByb3ZpZGVycy5rZXlzKCkpe2NvbnN0IHM9ZS5nZXQodCl8fG51bGw7cyYmcy5pZGVudGlmaWVyPT09dGhpcy5jdXJyZW50U3RhdGUucHJvdmlkZXJzLmdldCh0KS5pZGVudGlmaWVyP2UuZGVsZXRlKHQpOnRoaXMuZW50aXR5LnJlbW92ZSh0KX19ZWxzZSBlPXMucHJvdmlkZXJzO2Zvcihjb25zdCB0IG9mIGUua2V5cygpKXRoaXMuZW50aXR5LmFkZChlLmdldCh0KS5nZXRDb21wb25lbnQoKSx0KTt0aGlzLmN1cnJlbnRTdGF0ZT1zfWVsc2Ugcz1udWxsfX0sdC5FbmdpbmVTdGF0ZU1hY2hpbmU9Y2xhc3N7Y29uc3RydWN0b3IodCl7dGhpcy5lbmdpbmU9dCx0aGlzLnN0YXRlcz17fX1hZGRTdGF0ZSh0LGUpe3JldHVybiB0aGlzLnN0YXRlc1t0XT1lLHRoaXN9Y3JlYXRlU3RhdGUodCl7Y29uc3QgZT1uZXcgTjtyZXR1cm4gdGhpcy5zdGF0ZXNbdF09ZSxlfWNoYW5nZVN0YXRlKHQpe2xldCBlPXRoaXMuc3RhdGVzW3RdO2lmKCFlKXRocm93IG5ldyBFcnJvcihgRW5naW5lIHN0YXRlICR7dH0gZG9lc24ndCBleGlzdGApO2lmKGU9PT10aGlzLmN1cnJlbnRTdGF0ZSlyZXR1cm4gdm9pZChlPW51bGwpO2NvbnN0IHM9W107bGV0IGk7Zm9yKGNvbnN0IHQgb2YgZS5wcm92aWRlcnMpc1tpPXQuaWRlbnRpZmllcl09dDtpZih0aGlzLmN1cnJlbnRTdGF0ZSlmb3IoY29uc3QgdCBvZiB0aGlzLmN1cnJlbnRTdGF0ZS5wcm92aWRlcnMpc1tpPXQuaWRlbnRpZmllcl0/ZGVsZXRlIHNbaV06dGhpcy5lbmdpbmUucmVtb3ZlU3lzdGVtKHQuZ2V0U3lzdGVtKCkpO2Zvcihjb25zdCB0IG9mIHMpdGhpcy5lbmdpbmUuYWRkU3lzdGVtKHQuZ2V0U3lzdGVtKCksdC5wcmlvcml0eSk7dGhpcy5jdXJyZW50U3RhdGU9ZX19LHQuUkFGVGlja1Byb3ZpZGVyPWNsYXNzIGV4dGVuZHMgb3tjb25zdHJ1Y3Rvcigpe3N1cGVyKC4uLmFyZ3VtZW50cyksdGhpcy5yYWZJZD0wLHRoaXMucHJldmlvdXNUaW1lPTAsdGhpcy51cGRhdGU9KCgpPT57dGhpcy5yYWZJZD13aW5kb3cucmVxdWVzdEFuaW1hdGlvbkZyYW1lKHRoaXMudXBkYXRlKTtjb25zdCB0PURhdGUubm93KCk7dGhpcy5kaXNwYXRjaCgodC10aGlzLnByZXZpb3VzVGltZSkvMWUzKSx0aGlzLnByZXZpb3VzVGltZT10fSl9c3RhcnQoKXt0aGlzLnByZXZpb3VzVGltZT1EYXRlLm5vdygpLHRoaXMucmFmSWQ9d2luZG93LnJlcXVlc3RBbmltYXRpb25GcmFtZSh0aGlzLnVwZGF0ZSl9c3RvcCgpe3dpbmRvdy5jYW5jZWxBbmltYXRpb25GcmFtZSh0aGlzLnJhZklkKSx0aGlzLnJhZklkPTB9Z2V0IHBsYXlpbmcoKXtyZXR1cm4hIXRoaXMucmFmSWR9fSx0LkludGVydmFsVGlja1Byb3ZpZGVyPWNsYXNzIGV4dGVuZHMgb3tjb25zdHJ1Y3Rvcih0KXtzdXBlcigpLHRoaXMuaW50ZXJ2YWxJZD0wLHRoaXMucHJldmlvdXNUaW1lPTAsdGhpcy5wSW50ZXJ2YWw9MzMsdGhpcy51cGRhdGU9KCgpPT57Y29uc3QgdD1EYXRlLm5vdygpO3RoaXMuZGlzcGF0Y2goKHQtdGhpcy5wcmV2aW91c1RpbWUpLzFlMyksdGhpcy5wcmV2aW91c1RpbWU9dH0pLHQmJih0aGlzLnBJbnRlcnZhbD10KX1zdGFydCgpe3RoaXMucHJldmlvdXNUaW1lPURhdGUubm93KCksdGhpcy5pbnRlcnZhbElkPXdpbmRvdy5zZXRJbnRlcnZhbCh0aGlzLnVwZGF0ZSx0aGlzLnBJbnRlcnZhbCl9c3RvcCgpe3dpbmRvdy5jbGVhckludGVydmFsKHRoaXMuaW50ZXJ2YWxJZCksdGhpcy5pbnRlcnZhbElkPTB9c2V0IGludGVydmFsKHQpe3RoaXMucEludGVydmFsPXQsMCE9PXRoaXMuaW50ZXJ2YWxJZCYmKHdpbmRvdy5jbGVhckludGVydmFsKHRoaXMuaW50ZXJ2YWxJZCksdGhpcy5pbnRlcnZhbElkPXdpbmRvdy5zZXRJbnRlcnZhbCh0aGlzLnVwZGF0ZSx0KSl9Z2V0IGludGV2YWwoKXtyZXR1cm4gdGhpcy5wSW50ZXJ2YWx9Z2V0IHBsYXlpbmcoKXtyZXR1cm4hIXRoaXMuaW50ZXJ2YWxJZH19LHQuQ29tcG9uZW50UG9vbD1MLHQuTGlzdEl0ZXJhdGluZ1N5c3RlbT1jbGFzcyBleHRlbmRzIG17Y29uc3RydWN0b3IodCl7c3VwZXIoKSx0aGlzLm5vZGVMaXN0PW51bGwsdGhpcy5ub2RlQ2xhc3M9dH1hZGRUb0VuZ2luZSh0KXtpZih0aGlzLm5vZGVMaXN0PXQuZ2V0Tm9kZUxpc3QodGhpcy5ub2RlQ2xhc3MpLHRoaXMubm9kZUFkZGVkKXtmb3IobGV0IHQ9dGhpcy5ub2RlTGlzdC5oZWFkO3Q7dD10Lm5leHQpdGhpcy5ub2RlQWRkZWQodCk7dGhpcy5ub2RlTGlzdC5ub2RlQWRkZWQuYWRkKHRoaXMubm9kZUFkZGVkKX10aGlzLm5vZGVSZW1vdmVkJiZ0aGlzLm5vZGVMaXN0Lm5vZGVSZW1vdmVkLmFkZCh0aGlzLm5vZGVSZW1vdmVkKX1yZW1vdmVGcm9tRW5naW5lKHQpe3RoaXMubm9kZUFkZGVkJiZ0aGlzLm5vZGVMaXN0Lm5vZGVBZGRlZC5yZW1vdmUodGhpcy5ub2RlQWRkZWQpLHRoaXMubm9kZVJlbW92ZWQmJnRoaXMubm9kZUxpc3Qubm9kZVJlbW92ZWQucmVtb3ZlKHRoaXMubm9kZVJlbW92ZWQpLHRoaXMubm9kZUxpc3Q9bnVsbH11cGRhdGUodCl7Zm9yKGxldCBlPXRoaXMubm9kZUxpc3QuaGVhZDtlO2U9ZS5uZXh0KXRoaXMudXBkYXRlTm9kZShlLHQpfX0sT2JqZWN0LmRlZmluZVByb3BlcnR5KHQsXCJfX2VzTW9kdWxlXCIse3ZhbHVlOiEwfSl9KTtcclxuIiwiLyoqVGhpcyBjbGFzcyBpcyBhdXRvbWF0aWNhbGx5IGdlbmVyYXRlZCBieSBMYXlhQWlySURFLCBwbGVhc2UgZG8gbm90IG1ha2UgYW55IG1vZGlmaWNhdGlvbnMuICovXHJcbmltcG9ydCBHYW1lVUkgZnJvbSBcIi4vc2NyaXB0L0dhbWVVSVwiXHJcbmltcG9ydCBHYW1lQ29udHJvbCBmcm9tIFwiLi9zY3JpcHQvR2FtZUNvbnRyb2xcIlxyXG5pbXBvcnQgQnVsbGV0IGZyb20gXCIuL3NjcmlwdC9CdWxsZXRcIlxyXG5pbXBvcnQgRHJvcEJveCBmcm9tIFwiLi9zY3JpcHQvRHJvcEJveFwiXHJcbi8qXHJcbiog5ri45oiP5Yid5aeL5YyW6YWN572uO1xyXG4qL1xyXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBHYW1lQ29uZmlne1xyXG4gICAgc3RhdGljIHdpZHRoOm51bWJlcj02NDA7XHJcbiAgICBzdGF0aWMgaGVpZ2h0Om51bWJlcj0xMTM2O1xyXG4gICAgc3RhdGljIHNjYWxlTW9kZTpzdHJpbmc9XCJmaXhlZHdpZHRoXCI7XHJcbiAgICBzdGF0aWMgc2NyZWVuTW9kZTpzdHJpbmc9XCJub25lXCI7XHJcbiAgICBzdGF0aWMgc3RhcnRTY2VuZTpzdHJpbmc9XCJ0ZXN0L1Rlc3RTY2VuZS5zY2VuZVwiO1xyXG4gICAgc3RhdGljIHNjZW5lUm9vdDpzdHJpbmc9XCJcIjtcclxuICAgIHN0YXRpYyBkZWJ1Zzpib29sZWFuPWZhbHNlO1xyXG4gICAgc3RhdGljIHN0YXQ6Ym9vbGVhbj1mYWxzZTtcclxuICAgIHN0YXRpYyBwaHlzaWNzRGVidWc6Ym9vbGVhbj1mYWxzZTtcclxuICAgIHN0YXRpYyBleHBvcnRTY2VuZVRvSnNvbjpib29sZWFuPXRydWU7XHJcbiAgICBjb25zdHJ1Y3Rvcigpe31cclxuICAgIHN0YXRpYyBpbml0KCl7XHJcbiAgICAgICAgdmFyIHJlZzogRnVuY3Rpb24gPSBMYXlhLkNsYXNzVXRpbHMucmVnQ2xhc3M7XHJcbiAgICAgICAgcmVnKFwic2NyaXB0L0dhbWVVSS50c1wiLEdhbWVVSSk7XHJcbiAgICAgICAgcmVnKFwic2NyaXB0L0dhbWVDb250cm9sLnRzXCIsR2FtZUNvbnRyb2wpO1xyXG4gICAgICAgIHJlZyhcInNjcmlwdC9CdWxsZXQudHNcIixCdWxsZXQpO1xyXG4gICAgICAgIHJlZyhcInNjcmlwdC9Ecm9wQm94LnRzXCIsRHJvcEJveCk7XHJcbiAgICB9XHJcbn1cclxuR2FtZUNvbmZpZy5pbml0KCk7IiwiaW1wb3J0IEdhbWVDb25maWcgZnJvbSBcIi4vR2FtZUNvbmZpZ1wiO1xyXG5pbXBvcnQgeyBFbmdpbmUsIEVudGl0eSwgQ29tcG9uZW50UG9vbCB9IGZyb20gXCJhc2gudHNcIjtcclxuaW1wb3J0IHsgTW92ZVN5c3RlbSB9IGZyb20gXCIuL2Nlcy9zeXN0ZW1zL01vdmVTeXN0ZW1cIjtcclxuaW1wb3J0IHsgUG9zaXRpb25Db21wb25lbnQgfSBmcm9tIFwiLi9jZXMvY29tcG9uZW50cy9Qb3NpdGlvbkNvbXBvbmVudFwiO1xyXG5pbXBvcnQgeyBTcGVlZENvbXBvbmVudCB9IGZyb20gXCIuL2Nlcy9jb21wb25lbnRzL1NwZWVkQ29tcG9uZW50XCI7XHJcblxyXG5jbGFzcyBNYWluIHtcclxuXHRwcml2YXRlIF9lbmdpbmU6RW5naW5lO1xyXG5cdGNvbnN0cnVjdG9yKCkge1xyXG5cdFx0Ly/moLnmja5JREXorr7nva7liJ3lp4vljJblvJXmk45cdFx0XHJcblx0XHRpZiAod2luZG93W1wiTGF5YTNEXCJdKSBMYXlhM0QuaW5pdChHYW1lQ29uZmlnLndpZHRoLCBHYW1lQ29uZmlnLmhlaWdodCk7XHJcblx0XHRlbHNlIExheWEuaW5pdChHYW1lQ29uZmlnLndpZHRoLCBHYW1lQ29uZmlnLmhlaWdodCwgTGF5YVtcIldlYkdMXCJdKTtcclxuXHRcdExheWFbXCJQaHlzaWNzXCJdICYmIExheWFbXCJQaHlzaWNzXCJdLmVuYWJsZSgpO1xyXG5cdFx0TGF5YVtcIkRlYnVnUGFuZWxcIl0gJiYgTGF5YVtcIkRlYnVnUGFuZWxcIl0uZW5hYmxlKCk7XHJcblx0XHRMYXlhLnN0YWdlLnNjYWxlTW9kZSA9IEdhbWVDb25maWcuc2NhbGVNb2RlO1xyXG5cdFx0TGF5YS5zdGFnZS5zY3JlZW5Nb2RlID0gR2FtZUNvbmZpZy5zY3JlZW5Nb2RlO1xyXG5cdFx0Ly/lhbzlrrnlvq7kv6HkuI3mlK/mjIHliqDovb1zY2VuZeWQjue8gOWcuuaZr1xyXG5cdFx0TGF5YS5VUkwuZXhwb3J0U2NlbmVUb0pzb24gPSBHYW1lQ29uZmlnLmV4cG9ydFNjZW5lVG9Kc29uO1xyXG5cclxuXHRcdC8v5omT5byA6LCD6K+V6Z2i5p2/77yI6YCa6L+HSURF6K6+572u6LCD6K+V5qih5byP77yM5oiW6ICFdXJs5Zyw5Z2A5aKe5YqgZGVidWc9dHJ1ZeWPguaVsO+8jOWdh+WPr+aJk+W8gOiwg+ivlemdouadv++8iVxyXG5cdFx0aWYgKEdhbWVDb25maWcuZGVidWcgfHwgTGF5YS5VdGlscy5nZXRRdWVyeVN0cmluZyhcImRlYnVnXCIpID09IFwidHJ1ZVwiKSBMYXlhLmVuYWJsZURlYnVnUGFuZWwoKTtcclxuXHRcdGlmIChHYW1lQ29uZmlnLnBoeXNpY3NEZWJ1ZyAmJiBMYXlhW1wiUGh5c2ljc0RlYnVnRHJhd1wiXSkgTGF5YVtcIlBoeXNpY3NEZWJ1Z0RyYXdcIl0uZW5hYmxlKCk7XHJcblx0XHRpZiAoR2FtZUNvbmZpZy5zdGF0KSBMYXlhLlN0YXQuc2hvdygpO1xyXG5cdFx0TGF5YS5hbGVydEdsb2JhbEVycm9yID0gdHJ1ZTtcclxuXHJcblx0XHQvL+a/gOa0u+i1hOa6kOeJiOacrOaOp+WItu+8jHZlcnNpb24uanNvbueUsUlEReWPkeW4g+WKn+iDveiHquWKqOeUn+aIkO+8jOWmguaenOayoeacieS5n+S4jeW9seWTjeWQjue7rea1geeoi1xyXG5cdFx0Ly9MYXlhLlJlc291cmNlVmVyc2lvbi5lbmFibGUoXCJ2ZXJzaW9uLmpzb25cIiwgTGF5YS5IYW5kbGVyLmNyZWF0ZSh0aGlzLCB0aGlzLm9uVmVyc2lvbkxvYWRlZCksIExheWEuUmVzb3VyY2VWZXJzaW9uLkZJTEVOQU1FX1ZFUlNJT04pO1xyXG5cdFx0dGhpcy5pbml0KCk7XHJcblx0fVxyXG5cclxuXHRvblZlcnNpb25Mb2FkZWQoKTogdm9pZCB7XHJcblx0XHQvL+a/gOa0u+Wkp+Wwj+WbvuaYoOWwhO+8jOWKoOi9veWwj+WbvueahOaXtuWAme+8jOWmguaenOWPkeeOsOWwj+WbvuWcqOWkp+WbvuWQiOmbhumHjOmdou+8jOWImeS8mOWFiOWKoOi9veWkp+WbvuWQiOmbhu+8jOiAjOS4jeaYr+Wwj+WbvlxyXG5cdFx0TGF5YS5BdGxhc0luZm9NYW5hZ2VyLmVuYWJsZShcImZpbGVjb25maWcuanNvblwiLCBMYXlhLkhhbmRsZXIuY3JlYXRlKHRoaXMsIHRoaXMub25Db25maWdMb2FkZWQpKTtcclxuXHR9XHJcblxyXG5cdG9uQ29uZmlnTG9hZGVkKCk6IHZvaWQge1xyXG5cdFx0Ly/liqDovb1JREXmjIflrprnmoTlnLrmma9cclxuXHRcdEdhbWVDb25maWcuc3RhcnRTY2VuZSAmJiBMYXlhLlNjZW5lLm9wZW4oR2FtZUNvbmZpZy5zdGFydFNjZW5lKTtcclxuXHR9XHJcblxyXG5cdHByaXZhdGUgaW5pdCgpOnZvaWR7XHJcblx0XHR0aGlzLl9lbmdpbmUgPSBuZXcgRW5naW5lKCk7XHJcbiAgICAgICAgdGhpcy5fZW5naW5lLmFkZFN5c3RlbShuZXcgTW92ZVN5c3RlbSgpLCAwKTtcclxuICAgICAgICBMYXlhLnRpbWVyLmxvb3AoMTAwMCwgdGhpcywgdGhpcy51cGRhdGUpO1xyXG5cdH1cclxuXHJcblx0cHJpdmF0ZSB1cGRhdGUoKTp2b2lke1xyXG5cdFx0dGhpcy5fZW5naW5lLnVwZGF0ZShMYXlhLnRpbWVyLmRlbHRhKTtcclxuXHR9XHJcblxyXG5cdHB1YmxpYyBzZXR1cCgpOiB2b2lkIHtcclxuICAgICAgICBsZXQgZW50aXR5OiBFbnRpdHkgPSBuZXcgRW50aXR5KCk7XHJcblxyXG4gICAgICAgIGxldCBwb3NpdGlvbjogUG9zaXRpb25Db21wb25lbnQgPSBDb21wb25lbnRQb29sLmdldChQb3NpdGlvbkNvbXBvbmVudCk7XHJcbiAgICAgICAgcG9zaXRpb24uaW5pdGlhbGl6ZSgyLCAzLCA0KTtcclxuICAgICAgICBlbnRpdHkuYWRkKHBvc2l0aW9uKTtcclxuXHJcbiAgICAgICAgbGV0IHNwZWVkOlNwZWVkQ29tcG9uZW50ID0gQ29tcG9uZW50UG9vbC5nZXQoU3BlZWRDb21wb25lbnQpO1xyXG4gICAgICAgIHNwZWVkLmluaXRpYWxpemUoMTAsIDIsIDEpO1xyXG4gICAgICAgIGVudGl0eS5hZGQoc3BlZWQpO1xyXG5cclxuICAgICAgICB0aGlzLl9lbmdpbmUuYWRkRW50aXR5KGVudGl0eSk7XHJcbiAgICB9XHJcbn1cclxuLy/mv4DmtLvlkK/liqjnsbtcclxubmV3IE1haW4oKS5zZXR1cCgpO1xyXG4iLCJleHBvcnQgY2xhc3MgUG9zaXRpb25Db21wb25lbnQge1xyXG5cclxuICAgIHB1YmxpYyBwb3NYOiBudW1iZXI7XHJcbiAgICBwdWJsaWMgcG9zWTogbnVtYmVyO1xyXG4gICAgcHVibGljIHBvc1o6IG51bWJlcjtcclxuXHJcbiAgICBwdWJsaWMgY29uc3RydWN0b3IoKSAge1xyXG5cclxuICAgIH1cclxuXHJcbiAgICBwdWJsaWMgaW5pdGlhbGl6ZSh4OiBudW1iZXIgPSAwLjAsIHk6IG51bWJlciA9IDAuMCwgejogbnVtYmVyID0gMC4wKSAge1xyXG4gICAgICAgIHRoaXMucG9zWCA9IHg7XHJcbiAgICAgICAgdGhpcy5wb3NZID0geTtcclxuICAgICAgICB0aGlzLnBvc1ogPSB6O1xyXG4gICAgfVxyXG59IiwiZXhwb3J0IGNsYXNzIFNwZWVkQ29tcG9uZW50XHJcbntcclxuXHJcbiAgICBwdWJsaWMgc3BlZWRYOiBudW1iZXI7XHJcbiAgICBwdWJsaWMgc3BlZWRZOiBudW1iZXI7XHJcbiAgICBwdWJsaWMgc3BlZWRaOiBudW1iZXI7XHJcblxyXG4gICAgcHVibGljIGNvbnN0cnVjdG9yKClcclxuICAgIHtcclxuXHJcbiAgICB9XHJcblxyXG4gICAgcHVibGljIGluaXRpYWxpemUoIHg6IG51bWJlciA9IDAuMCwgeTogbnVtYmVyID0gMC4wLCB6OiBudW1iZXIgPSAwLjAgKVxyXG4gICAge1xyXG4gICAgICAgIHRoaXMuc3BlZWRYID0geDtcclxuICAgICAgICB0aGlzLnNwZWVkWSA9IHk7XHJcbiAgICAgICAgdGhpcy5zcGVlZFogPSB6O1xyXG4gICAgfVxyXG59IiwiaW1wb3J0IHsgTm9kZSwga2VlcCB9IGZyb20gXCJhc2gudHNcIjtcclxuaW1wb3J0IHsgUG9zaXRpb25Db21wb25lbnQgfSBmcm9tIFwiLi4vY29tcG9uZW50cy9Qb3NpdGlvbkNvbXBvbmVudFwiO1xyXG5pbXBvcnQgeyBTcGVlZENvbXBvbmVudCB9IGZyb20gXCIuLi9jb21wb25lbnRzL1NwZWVkQ29tcG9uZW50XCI7XHJcbmV4cG9ydCBjbGFzcyBNb3ZlTm9kZSBleHRlbmRzIE5vZGU8TW92ZU5vZGU+XHJcbntcclxuICAgIEBrZWVwKFBvc2l0aW9uQ29tcG9uZW50KVxyXG4gICAgcHVibGljIHBvczogUG9zaXRpb25Db21wb25lbnQ7XHJcbiAgICBAa2VlcChTcGVlZENvbXBvbmVudClcclxuICAgIHB1YmxpYyBzcGVlZDogU3BlZWRDb21wb25lbnQ7XHJcbn0iLCJpbXBvcnQgeyBMaXN0SXRlcmF0aW5nU3lzdGVtIH0gZnJvbSBcImFzaC50c1wiO1xyXG5pbXBvcnQgeyBNb3ZlTm9kZSB9IGZyb20gXCIuLi9ub2Rlcy9Nb3ZlTm9kZVwiO1xyXG5cclxuZXhwb3J0IGNsYXNzIE1vdmVTeXN0ZW0gZXh0ZW5kcyBMaXN0SXRlcmF0aW5nU3lzdGVtPE1vdmVOb2RlPntcclxuXHRjb25zdHJ1Y3RvcigpIHtcclxuXHRcdHN1cGVyKE1vdmVOb2RlKTtcclxuXHR9XHJcblxyXG5cdHB1YmxpYyB1cGRhdGVOb2RlKCBub2RlOiBNb3ZlTm9kZSwgZGVsdGE6IG51bWJlciApOiB2b2lkIHsgXHJcblx0XHRub2RlLnBvcy5wb3NYICs9IG5vZGUuc3BlZWQuc3BlZWRYO1xyXG5cdFx0Y29uc29sZS5sb2coXCJ4OiBcIiArIG5vZGUucG9zLnBvc1gpO1xyXG5cdH1cclxufSIsIi8qKlxyXG4gKiDlrZDlvLnohJrmnKzvvIzlrp7njrDlrZDlvLnpo57ooYzpgLvovpHlj4rlr7nosaHmsaDlm57mlLbmnLrliLZcclxuICovXHJcbmV4cG9ydCBkZWZhdWx0IGNsYXNzIEJ1bGxldCBleHRlbmRzIExheWEuU2NyaXB0IHtcclxuICAgIGNvbnN0cnVjdG9yKCkgeyBzdXBlcigpOyB9XHJcblxyXG4gICAgb25FbmFibGUoKTogdm9pZCB7XHJcbiAgICAgICAgLy/orr7nva7liJ3lp4vpgJ/luqZcclxuICAgICAgICB2YXIgcmlnOiBMYXlhLlJpZ2lkQm9keSA9IHRoaXMub3duZXIuZ2V0Q29tcG9uZW50KExheWEuUmlnaWRCb2R5KTtcclxuICAgICAgICByaWcuc2V0VmVsb2NpdHkoeyB4OiAwLCB5OiAtMTAgfSk7XHJcbiAgICB9XHJcblxyXG4gICAgb25UcmlnZ2VyRW50ZXIob3RoZXI6IGFueSwgc2VsZjogYW55LCBjb250YWN0OiBhbnkpOiB2b2lkIHtcclxuICAgICAgICAvL+WmguaenOiiq+eisOWIsO+8jOWImeenu+mZpOWtkOW8uVxyXG4gICAgICAgIHRoaXMub3duZXIucmVtb3ZlU2VsZigpO1xyXG4gICAgfVxyXG5cclxuICAgIG9uVXBkYXRlKCk6IHZvaWQge1xyXG4gICAgICAgIC8v5aaC5p6c5a2Q5by56LaF5Ye65bGP5bmV77yM5YiZ56e76Zmk5a2Q5by5XHJcbiAgICAgICAgaWYgKCh0aGlzLm93bmVyIGFzIExheWEuU3ByaXRlKS55IDwgLTEwKSB7XHJcbiAgICAgICAgICAgIHRoaXMub3duZXIucmVtb3ZlU2VsZigpO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICBvbkRpc2FibGUoKTogdm9pZCB7XHJcbiAgICAgICAgLy/lrZDlvLnooqvnp7vpmaTml7bvvIzlm57mlLblrZDlvLnliLDlr7nosaHmsaDvvIzmlrnkvr/kuIvmrKHlpI3nlKjvvIzlh4/lsJHlr7nosaHliJvlu7rlvIDplIBcclxuICAgICAgICBMYXlhLlBvb2wucmVjb3ZlcihcImJ1bGxldFwiLCB0aGlzLm93bmVyKTtcclxuICAgIH1cclxufSIsImltcG9ydCBHYW1lVUkgZnJvbSBcIi4vR2FtZVVJXCI7XHJcbi8qKlxyXG4gKiDmjonokL3nm5LlrZDohJrmnKzvvIzlrp7njrDnm5LlrZDnorDmkp7lj4rlm57mlLbmtYHnqItcclxuICovXHJcbmV4cG9ydCBkZWZhdWx0IGNsYXNzIERyb3BCb3ggZXh0ZW5kcyBMYXlhLlNjcmlwdCB7XHJcbiAgICAvKirnm5LlrZDnrYnnuqcgKi9cclxuICAgIGxldmVsOiBudW1iZXIgPSAxO1xyXG4gICAgLyoq562J57qn5paH5pys5a+56LGh5byV55SoICovXHJcbiAgICBwcml2YXRlIF90ZXh0OiBMYXlhLlRleHQ7XHJcbiAgICAvKirliJrkvZPlr7nosaHlvJXnlKggKi9cclxuICAgIHByaXZhdGUgX3JpZzogTGF5YS5SaWdpZEJvZHlcclxuXHJcbiAgICBjb25zdHJ1Y3RvcigpIHsgc3VwZXIoKTsgfVxyXG4gICAgb25FbmFibGUoKTogdm9pZCB7XHJcbiAgICAgICAgLyoq6I635b6X57uE5Lu25byV55So77yM6YG/5YWN5q+P5qyh6I635Y+W57uE5Lu25bim5p2l5LiN5b+F6KaB55qE5p+l6K+i5byA6ZSAICovXHJcbiAgICAgICAgdGhpcy5fcmlnID0gdGhpcy5vd25lci5nZXRDb21wb25lbnQoTGF5YS5SaWdpZEJvZHkpO1xyXG4gICAgICAgIHRoaXMubGV2ZWwgPSBNYXRoLnJvdW5kKE1hdGgucmFuZG9tKCkgKiA1KSArIDE7XHJcbiAgICAgICAgdGhpcy5fdGV4dCA9IHRoaXMub3duZXIuZ2V0Q2hpbGRCeU5hbWUoXCJsZXZlbFR4dFwiKSBhcyBMYXlhLlRleHQ7XHJcbiAgICAgICAgdGhpcy5fdGV4dC50ZXh0ID0gdGhpcy5sZXZlbCArIFwiXCI7XHJcbiAgICB9XHJcblxyXG4gICAgb25VcGRhdGUoKTogdm9pZCB7XHJcbiAgICAgICAgLy/orqnmjIHnu63nm5LlrZDml4vovaxcclxuICAgICAgICAodGhpcy5vd25lciBhcyBMYXlhLlNwcml0ZSkucm90YXRpb24rKztcclxuICAgIH1cclxuXHJcbiAgICBvblRyaWdnZXJFbnRlcihvdGhlcjogYW55LCBzZWxmOiBhbnksIGNvbnRhY3Q6IGFueSk6IHZvaWQge1xyXG4gICAgICAgIHZhciBvd25lcjogTGF5YS5TcHJpdGUgPSB0aGlzLm93bmVyIGFzIExheWEuU3ByaXRlO1xyXG4gICAgICAgIGlmIChvdGhlci5sYWJlbCA9PT0gXCJidXR0bGVcIikge1xyXG4gICAgICAgICAgICAvL+eisOaSnuWIsOWtkOW8ueWQju+8jOWinuWKoOenr+WIhu+8jOaSreaUvuWjsOmfs+eJueaViFxyXG4gICAgICAgICAgICBpZiAodGhpcy5sZXZlbCA+IDEpIHtcclxuICAgICAgICAgICAgICAgIHRoaXMubGV2ZWwtLTtcclxuICAgICAgICAgICAgICAgIHRoaXMuX3RleHQuY2hhbmdlVGV4dCh0aGlzLmxldmVsICsgXCJcIik7XHJcbiAgICAgICAgICAgICAgICBvd25lci5nZXRDb21wb25lbnQoTGF5YS5SaWdpZEJvZHkpLnNldFZlbG9jaXR5KHsgeDogMCwgeTogLTEwIH0pO1xyXG4gICAgICAgICAgICAgICAgTGF5YS5Tb3VuZE1hbmFnZXIucGxheVNvdW5kKFwic291bmQvaGl0LndhdlwiKTtcclxuICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgIGlmIChvd25lci5wYXJlbnQpIHtcclxuICAgICAgICAgICAgICAgICAgICBsZXQgZWZmZWN0OiBMYXlhLkFuaW1hdGlvbiA9IExheWEuUG9vbC5nZXRJdGVtQnlDcmVhdGVGdW4oXCJlZmZlY3RcIiwgdGhpcy5jcmVhdGVFZmZlY3QsIHRoaXMpO1xyXG4gICAgICAgICAgICAgICAgICAgIGVmZmVjdC5wb3Mob3duZXIueCwgb3duZXIueSk7XHJcbiAgICAgICAgICAgICAgICAgICAgb3duZXIucGFyZW50LmFkZENoaWxkKGVmZmVjdCk7XHJcbiAgICAgICAgICAgICAgICAgICAgZWZmZWN0LnBsYXkoMCwgdHJ1ZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgb3duZXIucmVtb3ZlU2VsZigpO1xyXG4gICAgICAgICAgICAgICAgICAgIExheWEuU291bmRNYW5hZ2VyLnBsYXlTb3VuZChcInNvdW5kL2Rlc3Ryb3kud2F2XCIpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIEdhbWVVSS5pbnN0YW5jZS5hZGRTY29yZSgxKTtcclxuICAgICAgICB9IGVsc2UgaWYgKG90aGVyLmxhYmVsID09PSBcImdyb3VuZFwiKSB7XHJcbiAgICAgICAgICAgIC8v5Y+q6KaB5pyJ5LiA5Liq55uS5a2Q56Kw5Yiw5Zyw5p2/77yM5YiZ5YGc5q2i5ri45oiPXHJcbiAgICAgICAgICAgIG93bmVyLnJlbW92ZVNlbGYoKTtcclxuICAgICAgICAgICAgR2FtZVVJLmluc3RhbmNlLnN0b3BHYW1lKCk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIC8qKuS9v+eUqOWvueixoeaxoOWIm+W7uueIhueCuOWKqOeUuyAqL1xyXG4gICAgY3JlYXRlRWZmZWN0KCk6IExheWEuQW5pbWF0aW9uIHtcclxuICAgICAgICBsZXQgYW5pOiBMYXlhLkFuaW1hdGlvbiA9IG5ldyBMYXlhLkFuaW1hdGlvbigpO1xyXG4gICAgICAgIGFuaS5sb2FkQW5pbWF0aW9uKFwidGVzdC9UZXN0QW5pLmFuaVwiKTtcclxuICAgICAgICBhbmkub24oTGF5YS5FdmVudC5DT01QTEVURSwgbnVsbCwgcmVjb3Zlcik7XHJcbiAgICAgICAgZnVuY3Rpb24gcmVjb3ZlcigpOiB2b2lkIHtcclxuICAgICAgICAgICAgYW5pLnJlbW92ZVNlbGYoKTtcclxuICAgICAgICAgICAgTGF5YS5Qb29sLnJlY292ZXIoXCJlZmZlY3RcIiwgYW5pKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIGFuaTtcclxuICAgIH1cclxuXHJcbiAgICBvbkRpc2FibGUoKTogdm9pZCB7XHJcbiAgICAgICAgLy/nm5LlrZDooqvnp7vpmaTml7bvvIzlm57mlLbnm5LlrZDliLDlr7nosaHmsaDvvIzmlrnkvr/kuIvmrKHlpI3nlKjvvIzlh4/lsJHlr7nosaHliJvlu7rlvIDplIDjgIJcclxuICAgICAgICBMYXlhLlBvb2wucmVjb3ZlcihcImRyb3BCb3hcIiwgdGhpcy5vd25lcik7XHJcbiAgICB9XHJcbn0iLCJcclxuaW1wb3J0IERyb3BCb3ggZnJvbSBcIi4vRHJvcEJveFwiO1xyXG5pbXBvcnQgQnVsbGV0IGZyb20gXCIuL0J1bGxldFwiO1xyXG4vKipcclxuICog5ri45oiP5o6n5Yi26ISa5pys44CC5a6a5LmJ5LqG5Yeg5LiqZHJvcEJveO+8jGJ1bGxldO+8jGNyZWF0ZUJveEludGVydmFs562J5Y+Y6YeP77yM6IO95aSf5ZyoSURF5pi+56S65Y+K6K6+572u6K+l5Y+Y6YePXHJcbiAqIOabtOWkmuexu+Wei+WumuS5ie+8jOivt+WPguiAg+WumOaWueaWh+aho1xyXG4gKi9cclxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgR2FtZUNvbnRyb2wgZXh0ZW5kcyBMYXlhLlNjcmlwdCB7XHJcbiAgICAvKiogQHByb3Age25hbWU6ZHJvcEJveCx0aXBzOlwi5o6J6JC95a655Zmo6aKE5Yi25L2T5a+56LGhXCIsdHlwZTpQcmVmYWJ9Ki9cclxuICAgIGRyb3BCb3g6IExheWEuUHJlZmFiO1xyXG4gICAgLyoqIEBwcm9wIHtuYW1lOmJ1bGxldCx0aXBzOlwi5a2Q5by56aKE5Yi25L2T5a+56LGhXCIsdHlwZTpQcmVmYWJ9Ki9cclxuICAgIGJ1bGxldDogTGF5YS5QcmVmYWI7XHJcbiAgICAvKiogQHByb3Age25hbWU6Y3JlYXRlQm94SW50ZXJ2YWwsdGlwczpcIumXtOmalOWkmuWwkeavq+enkuWIm+W7uuS4gOS4quS4i+i3jOeahOWuueWZqFwiLHR5cGU6aW50LGRlZmF1bHQ6MTAwMH0qL1xyXG4gICAgY3JlYXRlQm94SW50ZXJ2YWw6IG51bWJlciA9IDEwMDA7XHJcbiAgICAvKirlvIDlp4vml7bpl7QqL1xyXG4gICAgcHJpdmF0ZSBfdGltZTogbnVtYmVyID0gMDtcclxuICAgIC8qKuaYr+WQpuW3sue7j+W8gOWni+a4uOaIjyAqL1xyXG4gICAgcHJpdmF0ZSBfc3RhcnRlZDogYm9vbGVhbiA9IGZhbHNlO1xyXG4gICAgLyoq5a2Q5by55ZKM55uS5a2Q5omA5Zyo55qE5a655Zmo5a+56LGhICovXHJcbiAgICBwcml2YXRlIF9nYW1lQm94OiBMYXlhLlNwcml0ZTtcclxuXHJcbiAgICBjb25zdHJ1Y3RvcigpIHsgc3VwZXIoKTsgfVxyXG5cclxuICAgIG9uRW5hYmxlKCk6IHZvaWQge1xyXG4gICAgICAgIHRoaXMuX3RpbWUgPSBEYXRlLm5vdygpO1xyXG4gICAgICAgIHRoaXMuX2dhbWVCb3ggPSB0aGlzLm93bmVyLmdldENoaWxkQnlOYW1lKFwiZ2FtZUJveFwiKSBhcyBMYXlhLlNwcml0ZTtcclxuICAgICAgICB0aGlzLmNyZWF0ZUJveCgpO1xyXG4gICAgfVxyXG5cclxuICAgIG9uVXBkYXRlKCk6IHZvaWQge1xyXG4gICAgICAgIC8v5q+P6Ze06ZqU5LiA5q615pe26Ze05Yib5bu65LiA5Liq55uS5a2QXHJcbiAgICAgICAgbGV0IG5vdyA9IERhdGUubm93KCk7XHJcbiAgICAgICAgaWYgKG5vdyAtIHRoaXMuX3RpbWUgPiB0aGlzLmNyZWF0ZUJveEludGVydmFsKSB7XHJcbiAgICAgICAgICAgIHRoaXMuX3RpbWUgPSBub3c7XHJcbiAgICAgICAgICAgIHRoaXMuY3JlYXRlQm94KCk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIGNyZWF0ZUJveCgpOiB2b2lkIHtcclxuICAgICAgICAvL+S9v+eUqOWvueixoeaxoOWIm+W7uuebkuWtkFxyXG4gICAgICAgIGxldCBib3g6IExheWEuU3ByaXRlID0gTGF5YS5Qb29sLmdldEl0ZW1CeUNyZWF0ZUZ1bihcImRyb3BCb3hcIiwgdGhpcy5kcm9wQm94LmNyZWF0ZSwgdGhpcy5kcm9wQm94KTtcclxuICAgICAgICBib3gucG9zKE1hdGgucmFuZG9tKCkgKiAoTGF5YS5zdGFnZS53aWR0aCAtIDEwMCksIC0xMDApO1xyXG4gICAgICAgIHRoaXMuX2dhbWVCb3guYWRkQ2hpbGQoYm94KTtcclxuICAgIH1cclxuXHJcbiAgICBvblN0YWdlQ2xpY2soZTogTGF5YS5FdmVudCk6IHZvaWQge1xyXG4gICAgICAgIC8v5YGc5q2i5LqL5Lu25YaS5rOh77yM5o+Q6auY5oCn6IO977yM5b2T54S25Lmf5Y+v5Lul5LiN6KaBXHJcbiAgICAgICAgZS5zdG9wUHJvcGFnYXRpb24oKTtcclxuICAgICAgICAvL+iInuWPsOiiq+eCueWHu+WQju+8jOS9v+eUqOWvueixoeaxoOWIm+W7uuWtkOW8uVxyXG4gICAgICAgIGxldCBmbHllcjogTGF5YS5TcHJpdGUgPSBMYXlhLlBvb2wuZ2V0SXRlbUJ5Q3JlYXRlRnVuKFwiYnVsbGV0XCIsIHRoaXMuYnVsbGV0LmNyZWF0ZSwgdGhpcy5idWxsZXQpO1xyXG4gICAgICAgIGZseWVyLnBvcyhMYXlhLnN0YWdlLm1vdXNlWCwgTGF5YS5zdGFnZS5tb3VzZVkpO1xyXG4gICAgICAgIHRoaXMuX2dhbWVCb3guYWRkQ2hpbGQoZmx5ZXIpO1xyXG4gICAgfVxyXG5cclxuICAgIC8qKuW8gOWni+a4uOaIj++8jOmAmui/h+a/gOa0u+acrOiEmuacrOaWueW8j+W8gOWni+a4uOaIjyovXHJcbiAgICBzdGFydEdhbWUoKTogdm9pZCB7XHJcbiAgICAgICAgaWYgKCF0aGlzLl9zdGFydGVkKSB7XHJcbiAgICAgICAgICAgIHRoaXMuX3N0YXJ0ZWQgPSB0cnVlO1xyXG4gICAgICAgICAgICB0aGlzLmVuYWJsZWQgPSB0cnVlO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICAvKirnu5PmnZ/muLjmiI/vvIzpgJrov4fpnZ7mv4DmtLvmnKzohJrmnKzlgZzmraLmuLjmiI8gKi9cclxuICAgIHN0b3BHYW1lKCk6IHZvaWQge1xyXG4gICAgICAgIHRoaXMuX3N0YXJ0ZWQgPSBmYWxzZTtcclxuICAgICAgICB0aGlzLmVuYWJsZWQgPSBmYWxzZTtcclxuICAgICAgICB0aGlzLmNyZWF0ZUJveEludGVydmFsID0gMTAwMDtcclxuICAgICAgICB0aGlzLl9nYW1lQm94LnJlbW92ZUNoaWxkcmVuKCk7XHJcbiAgICB9XHJcbn0iLCJpbXBvcnQgeyB1aSB9IGZyb20gXCIuLy4uL3VpL2xheWFNYXhVSVwiO1xyXG5pbXBvcnQgR2FtZUNvbnRyb2wgZnJvbSBcIi4vR2FtZUNvbnRyb2xcIlxyXG4vKipcclxuICog5pys56S65L6L6YeH55So6Z2e6ISa5pys55qE5pa55byP5a6e546w77yM6ICM5L2/55So57un5om/6aG16Z2i5Z+657G777yM5a6e546w6aG16Z2i6YC76L6R44CC5ZyoSURF6YeM6Z2i6K6+572u5Zy65pmv55qEUnVudGltZeWxnuaAp+WNs+WPr+WSjOWcuuaZr+i/m+ihjOWFs+iBlFxyXG4gKiDnm7jmr5TohJrmnKzmlrnlvI/vvIznu6fmib/lvI/pobXpnaLnsbvvvIzlj6/ku6Xnm7TmjqXkvb/nlKjpobXpnaLlrprkuYnnmoTlsZ7mgKfvvIjpgJrov4dJREXlhoV2YXLlsZ7mgKflrprkuYnvvInvvIzmr5TlpoJ0aGlzLnRpcExibGzvvIx0aGlzLnNjb3JlTGJs77yM5YW35pyJ5Luj56CB5o+Q56S65pWI5p6cXHJcbiAqIOW7uuiuru+8muWmguaenOaYr+mhtemdoue6p+eahOmAu+i+ke+8jOmcgOimgemikee5geiuv+mXrumhtemdouWGheWkmuS4quWFg+e0oO+8jOS9v+eUqOe7p+aJv+W8j+WGmeazle+8jOWmguaenOaYr+eLrOeri+Wwj+aooeWdl++8jOWKn+iDveWNleS4gO+8jOW7uuiurueUqOiEmuacrOaWueW8j+WunueOsO+8jOavlOWmguWtkOW8ueiEmuacrOOAglxyXG4gKi9cclxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgR2FtZVVJIGV4dGVuZHMgdWkudGVzdC5UZXN0U2NlbmVVSSB7XHJcbiAgICAvKirorr7nva7ljZXkvovnmoTlvJXnlKjmlrnlvI/vvIzmlrnkvr/lhbbku5bnsbvlvJXnlKggKi9cclxuICAgIHN0YXRpYyBpbnN0YW5jZTogR2FtZVVJO1xyXG4gICAgLyoq5b2T5YmN5ri45oiP56ev5YiG5a2X5q61ICovXHJcbiAgICBwcml2YXRlIF9zY29yZTogbnVtYmVyO1xyXG4gICAgLyoq5ri45oiP5o6n5Yi26ISa5pys5byV55So77yM6YG/5YWN5q+P5qyh6I635Y+W57uE5Lu25bim5p2l5LiN5b+F6KaB55qE5oCn6IO95byA6ZSAICovXHJcbiAgICBwcml2YXRlIF9jb250cm9sOiBHYW1lQ29udHJvbDtcclxuXHJcbiAgICBjb25zdHJ1Y3RvcigpIHtcclxuICAgICAgICBzdXBlcigpO1xyXG4gICAgICAgIEdhbWVVSS5pbnN0YW5jZSA9IHRoaXM7XHJcbiAgICAgICAgLy/lhbPpl63lpJrngrnop6bmjqfvvIzlkKbliJnlsLHml6DmlYzkuoZcclxuICAgICAgICBMYXlhLk1vdXNlTWFuYWdlci5tdWx0aVRvdWNoRW5hYmxlZCA9IGZhbHNlO1xyXG4gICAgfVxyXG5cclxuICAgIG9uRW5hYmxlKCk6IHZvaWQge1xyXG4gICAgICAgIHRoaXMuX2NvbnRyb2wgPSB0aGlzLmdldENvbXBvbmVudChHYW1lQ29udHJvbCk7XHJcbiAgICAgICAgLy/ngrnlh7vmj5DnpLrmloflrZfvvIzlvIDlp4vmuLjmiI9cclxuICAgICAgICB0aGlzLnRpcExibGwub24oTGF5YS5FdmVudC5DTElDSywgdGhpcywgdGhpcy5vblRpcENsaWNrKTtcclxuICAgIH1cclxuXHJcbiAgICBvblRpcENsaWNrKGU6IExheWEuRXZlbnQpOiB2b2lkIHtcclxuICAgICAgICB0aGlzLnRpcExibGwudmlzaWJsZSA9IGZhbHNlO1xyXG4gICAgICAgIHRoaXMuX3Njb3JlID0gMDtcclxuICAgICAgICB0aGlzLnNjb3JlTGJsLnRleHQgPSBcIlwiO1xyXG4gICAgICAgIHRoaXMuX2NvbnRyb2wuc3RhcnRHYW1lKCk7XHJcbiAgICB9XHJcblxyXG4gICAgLyoq5aKe5Yqg5YiG5pWwICovXHJcbiAgICBhZGRTY29yZSh2YWx1ZTogbnVtYmVyID0gMSk6IHZvaWQge1xyXG4gICAgICAgIHRoaXMuX3Njb3JlICs9IHZhbHVlO1xyXG4gICAgICAgIHRoaXMuc2NvcmVMYmwuY2hhbmdlVGV4dChcIuWIhuaVsO+8mlwiICsgdGhpcy5fc2NvcmUpO1xyXG4gICAgICAgIC8v6ZqP552A5YiG5pWw6LaK6auY77yM6Zq+5bqm5aKe5aSnXHJcbiAgICAgICAgaWYgKHRoaXMuX2NvbnRyb2wuY3JlYXRlQm94SW50ZXJ2YWwgPiA2MDAgJiYgdGhpcy5fc2NvcmUgJSAyMCA9PSAwKSB0aGlzLl9jb250cm9sLmNyZWF0ZUJveEludGVydmFsIC09IDIwO1xyXG4gICAgfVxyXG5cclxuICAgIC8qKuWBnOatoua4uOaIjyAqL1xyXG4gICAgc3RvcEdhbWUoKTogdm9pZCB7XHJcbiAgICAgICAgdGhpcy50aXBMYmxsLnZpc2libGUgPSB0cnVlO1xyXG4gICAgICAgIHRoaXMudGlwTGJsbC50ZXh0ID0gXCLmuLjmiI/nu5PmnZ/kuobvvIzngrnlh7vlsY/luZXph43mlrDlvIDlp4tcIjtcclxuICAgICAgICB0aGlzLl9jb250cm9sLnN0b3BHYW1lKCk7XHJcbiAgICB9XHJcbn0iLCIvKipUaGlzIGNsYXNzIGlzIGF1dG9tYXRpY2FsbHkgZ2VuZXJhdGVkIGJ5IExheWFBaXJJREUsIHBsZWFzZSBkbyBub3QgbWFrZSBhbnkgbW9kaWZpY2F0aW9ucy4gKi9cclxuaW1wb3J0IFZpZXc9TGF5YS5WaWV3O1xyXG5pbXBvcnQgRGlhbG9nPUxheWEuRGlhbG9nO1xyXG5pbXBvcnQgU2NlbmU9TGF5YS5TY2VuZTtcclxuZXhwb3J0IG1vZHVsZSB1aS50ZXN0IHtcclxuICAgIGV4cG9ydCBjbGFzcyBUZXN0U2NlbmVVSSBleHRlbmRzIFNjZW5lIHtcclxuXHRcdHB1YmxpYyBzY29yZUxibDpMYXlhLkxhYmVsO1xyXG5cdFx0cHVibGljIHRpcExibGw6TGF5YS5MYWJlbDtcclxuICAgICAgICBjb25zdHJ1Y3RvcigpeyBzdXBlcigpfVxyXG4gICAgICAgIGNyZWF0ZUNoaWxkcmVuKCk6dm9pZCB7XHJcbiAgICAgICAgICAgIHN1cGVyLmNyZWF0ZUNoaWxkcmVuKCk7XHJcbiAgICAgICAgICAgIHRoaXMubG9hZFNjZW5lKFwidGVzdC9UZXN0U2NlbmVcIik7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG59XHJcbiJdfQ==
